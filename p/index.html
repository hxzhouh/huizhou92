<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name="baidu-site-verification" content="codeva-3VTxLtnqFP" /><meta name='description' content="Detecting Goroutine Leaks Like Memory Leaks? goroutineleak Helps Us Pinpoint Goroutine Leaks Faster Introduction In Go development, goroutine leaks are a common but subtle problem: when a goroutine is blocked on some synchronization primitive (such as a channel or mutex), and that primitive becomes permanently unreachable, the goroutine is effectively “leaked.”\nEach leaked goroutine occupies at least 2 KB of stack memory. Over time this can cause:\nSteadily increasing memory usage More pressure on the scheduler Eventually, OOM crashes or noticeable service performance degradation Previously, developers typically relied on manual code review or third-party tools (such as goleak) to detect goroutine leaks—both low in efficiency and easy to miss issues. But Go’s experimental feature goroutineleak changes that.\n">
<title></title>

<link rel='canonical' href='https://huizhou92.com/p/'>

<link rel="stylesheet" href="/scss/style.min.7a8650e463f7bf12cc86f69675ab60349b39aa794883f0c4ba0547d9e71cd5b5.css"><meta property='og:title' content="">
<meta property='og:description' content="Detecting Goroutine Leaks Like Memory Leaks? goroutineleak Helps Us Pinpoint Goroutine Leaks Faster Introduction In Go development, goroutine leaks are a common but subtle problem: when a goroutine is blocked on some synchronization primitive (such as a channel or mutex), and that primitive becomes permanently unreachable, the goroutine is effectively “leaked.”\nEach leaked goroutine occupies at least 2 KB of stack memory. Over time this can cause:\nSteadily increasing memory usage More pressure on the scheduler Eventually, OOM crashes or noticeable service performance degradation Previously, developers typically relied on manual code review or third-party tools (such as goleak) to detect goroutine leaks—both low in efficiency and easy to miss issues. But Go’s experimental feature goroutineleak changes that.\n">
<meta property='og:url' content='https://huizhou92.com/p/'>
<meta property='og:site_name' content='huizhou92&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:site" content="@piaopiaopig">
    <meta name="twitter:creator" content="@piaopiaopig"><meta name="twitter:title" content="">
<meta name="twitter:description" content="Detecting Goroutine Leaks Like Memory Leaks? goroutineleak Helps Us Pinpoint Goroutine Leaks Faster Introduction In Go development, goroutine leaks are a common but subtle problem: when a goroutine is blocked on some synchronization primitive (such as a channel or mutex), and that primitive becomes permanently unreachable, the goroutine is effectively “leaked.”\nEach leaked goroutine occupies at least 2 KB of stack memory. Over time this can cause:\nSteadily increasing memory usage More pressure on the scheduler Eventually, OOM crashes or noticeable service performance degradation Previously, developers typically relied on manual code review or third-party tools (such as goleak) to detect goroutine leaks—both low in efficiency and easy to miss issues. But Go’s experimental feature goroutineleak changes that.\n">
    <link rel="shortcut icon" href="/favicon.png" />

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-JMPMQ2QREG"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-JMPMQ2QREG');
        }
      </script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9000447749076746"
crossorigin="anonymous"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9000447749076746"
     crossorigin="anonymous"></script>

<script defer src="https://cloud.umami.is/script.js" data-website-id="e4ee8ffe-fb88-4635-9953-715598461baa"></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_e52293b5d2b8c5f7.jpeg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">huizhou92&#39;s Blog</a></h1>
            <h2 class="site-description">Backend Engineer With A Focus On Golang, Cloud Computing, Data Storage And Efficiency Tools. Lifelong Learner.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/hxzhouh'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/piaopiaopig'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://huizhou92.com/" selected>English</option>
                                
                                    <option value="https://huizhou92.com/zh-cn/" >中文</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>


<ins class="adsbygoogle"
   style="display:block"
   data-ad-client="ca-pub-9000447749076746"
   data-ad-slot="5063552270"
   data-ad-format="auto"
   data-full-width-responsive="true"></ins>
<script>
   (adsbygoogle = window.adsbygoogle || []).push({});
</script>


    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#how-to-use-geminimd-custom-toml-commands-shell-integration-and-checkpoints-to-supercharge-your-local-workflows">How to Use GEMINI.md, Custom TOML Commands, Shell Integration, and Checkpoints to Supercharge Your Local Workflows</a></li>
      </ol>
    </li>
    <li><a href="#geminimd-your-projects-built-in-factory-settings"><code>GEMINI.md</code>: Your Project’s Built-In “Factory Settings”</a></li>
    <li><a href="#running-shell-commands-inside-gemini-cli">Running Shell Commands Inside Gemini CLI</a></li>
    <li><a href="#custom-commands-with-toml-automate-your-repetitive-work">Custom Commands with TOML: Automate Your Repetitive Work</a>
      <ol>
        <li><a href="#advanced-usage-dynamic-parameters-and-shell-integration">Advanced Usage: Dynamic Parameters and Shell Integration</a></li>
        <li><a href="#dynamic-arguments-">Dynamic Arguments: <code>*</code></a></li>
        <li><a href="#shell-injection-">Shell Injection: <code>!{...}</code></a></li>
      </ol>
    </li>
    <li><a href="#real-world-example-intelligent-git-commit-message-generator">Real-World Example: Intelligent Git Commit Message Generator</a>
      <ol>
        <li><a href="#checkpoints-and-rollback-restore-as-a-safety-net">Checkpoints and Rollback: <code>/restore</code> as a Safety Net</a></li>
        <li><a href="#how-checkpointing-works">How Checkpointing Works</a></li>
        <li><a href="#enabling-checkpointing">Enabling Checkpointing</a></li>
        <li><a href="#restoring-a-checkpoint">Restoring a Checkpoint</a></li>
      </ol>
    </li>
    <li><a href="#working-with-multiple-directories-at-once">Working with Multiple Directories at Once</a></li>
  </ol>
</nav>
        </div>
    </section>


<ins class="adsbygoogle"
   style="display:block"
   data-ad-client="ca-pub-9000447749076746"
   data-ad-slot="5063552270"
   data-ad-format="auto"
   data-full-width-responsive="true"></ins>
<script>
   (adsbygoogle = window.adsbygoogle || []).push({});
</script>
            
        
              
              <section class="widget">
                 
                <div class="widget-content">
                    <iframe frameborder="0"
                        src="https://support.nodeget.com/page/promotion?id=30795"
                        style="border-radius:8px; height: 270px; width: 100%; display: block;"></iframe>
                        
                </div>
            </section>
    </aside>
  




<ins class="adsbygoogle"
   style="display:block"
   data-ad-client="ca-pub-9000447749076746"
   data-ad-slot="5063552270"
   data-ad-format="auto"
   data-full-width-responsive="true"></ins>
<script>
   (adsbygoogle = window.adsbygoogle || []).push({});
</script>



            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/"></a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
         
        <div class="article-analysic">&nbsp
    
            <?xml version="1.0" encoding="utf-8"?>

<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg fill="#000000" width="800px" height="800px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  
  <g id="read">
    <g>
      <path  d="M12,18.883a10.8,10.8,0,0,1-9.675-5.728,2.6,2.6,0,0,1,0-2.31A10.8,10.8,0,0,1,12,5.117a10.8,10.8,0,0,1,9.675,5.728h0a2.6,2.6,0,0,1,0,2.31A10.8,10.8,0,0,1,12,18.883ZM12,6.117a9.787,9.787,0,0,0-8.78,5.176,1.586,1.586,0,0,0,0,1.415A9.788,9.788,0,0,0,12,17.883a9.787,9.787,0,0,0,8.78-5.176,1.584,1.584,0,0,0,0-1.414h0A9.787,9.787,0,0,0,12,6.117Z"/>
      <path  d="M12,16.049A4.049,4.049,0,1,1,16.049,12,4.054,4.054,0,0,1,12,16.049Zm0-7.1A3.049,3.049,0,1,0,15.049,12,3.052,3.052,0,0,0,12,8.951Z"/>
      <circle  cx="12" cy="12" r="2.028"/>
    </g>
  </g>
</svg>
            <time class="article-words">
                <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span> &nbspReads</span>
            </time>
        </div>
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="gemini-cli-power-tips-turning-googles-ai-assistant-into-your-everyday-dev-copilot">Gemini CLI Power Tips: Turning Google’s AI Assistant Into Your Everyday Dev Copilot
</h1><h3 id="how-to-use-geminimd-custom-toml-commands-shell-integration-and-checkpoints-to-supercharge-your-local-workflows">How to Use GEMINI.md, Custom TOML Commands, Shell Integration, and Checkpoints to Supercharge Your Local Workflows
</h3><p>Gemini CLI is Google’s AI assistant for the terminal. Similar tools include Codex and Claude Code, but in my experience Gemini CLI is noticeably stronger when it comes to working with <strong>local files and project context</strong>.</p>
<p>Because of that, it has quietly become my primary daily driver.</p>
<p>Below are a few practical tips from real use, especially around <code>GEMINI.md</code>, custom TOML commands, shell integration, and safe rollback.</p>
<hr>
<h2 id="geminimd-your-projects-built-in-factory-settings"><code>GEMINI.md</code>: Your Project’s Built-In “Factory Settings”
</h2><p><code>GEMINI.md</code> (similar to <code>CLAUDE.md</code>) is designed to store <strong>project-specific context</strong>.</p>
<p>Every time you start Gemini CLI in a project directory, it will automatically load the content of this file. Think of it as giving the AI a <strong>project “factory preset”</strong> so it instantly understands your:</p>
<ul>
<li>specification</li>
<li>common commands</li>
<li>coding standards</li>
<li>gotchas and caveats</li>
</ul>
<p>You can use <code>GEMINI.md</code> to define things like:</p>
<ol>
<li><strong>Project overview</strong> – what this project does, high-level architecture, core tech stack.</li>
<li><strong>Common commands</strong> – build, test, deploy, lint, etc., so Gemini can suggest or even call them directly.</li>
<li><strong>Coding standards</strong> – naming conventions, library versions, architectural patterns you want to enforce.</li>
<li><strong>Directory layout</strong> – what the important folders do, especially for non-standard structures.</li>
</ol>
<p>Example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-md" data-lang="md"><span class="line"><span class="cl"><span class="gh"># Project Context for Gemini 
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>
</span></span><span class="line"><span class="cl"><span class="gu">## Build &amp; Run 
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">-</span> Build: <span class="sb">`npm run build`</span> 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Dev Server: <span class="sb">`npm run dev`</span> 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Test: <span class="sb">`npm test`</span> 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Lint: <span class="sb">`npm run lint`</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Coding Standards 
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">-</span> Use TypeScript for all new files. 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Prefer functional components with Hooks for React. 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Use <span class="sb">`styled-components`</span> for styling. 
</span></span><span class="line"><span class="cl"><span class="k">-</span> Error handling: Wrap async calls in try/catch blocks. 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Architecture 
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">-</span> <span class="sb">`/src/components`</span>: Reusable UI components. 
</span></span><span class="line"><span class="cl"><span class="k">-</span> <span class="sb">`/src/pages`</span>: Next.js pages. 
</span></span><span class="line"><span class="cl"><span class="k">-</span> <span class="sb">`/src/lib`</span>: Utility functions and API clients.
</span></span></code></pre></td></tr></table>
</div>
</div><p>In my notes vault, I keep a <code>GEMINI.md</code> alongside each project so Gemini CLI always boots with the right mental model.</p>
<h2 id="running-shell-commands-inside-gemini-cli">Running Shell Commands Inside Gemini CLI
</h2><p>Gemini CLI has a built-in <strong>shell mode</strong>.</p>
<p>Type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">!
</span></span></code></pre></td></tr></table>
</div>
</div><p>to enter shell mode:</p>
<p><img src="https://images.hxzhouh.com/blog-images/2025/12/4459de874a2caaf1f827ad41246fa401.png"
	
	
	
	loading="lazy"
	
		alt="Gemini CLI shell mode screenshot"
	
	
></p>
<p>This lets you quickly jump between:</p>
<ul>
<li>chatting with the AI</li>
<li>running commands in your project</li>
</ul>
<p>without leaving the CLI.</p>
<h2 id="custom-commands-with-toml-automate-your-repetitive-work">Custom Commands with TOML: Automate Your Repetitive Work
</h2><p>Gemini CLI lets you define <strong>Slash Commands</strong> (like <code>/weekly</code>) using <code>.toml</code> config files.<br>
These commands encapsulate complex prompts and logic into <strong>simple, reusable shortcuts</strong> — great for both team workflows and your personal routines.<br>
You can define two types of commands:</p>
<ol>
<li>
<p><strong>Global commands</strong></p>
<ul>
<li>Stored in <code>~/.gemini/commands/</code></li>
<li>Available in all projects</li>
<li>Good for generic tasks like “explain this code” or “translate this file”</li>
</ul>
</li>
<li>
<p><strong>Project-scoped commands</strong></p>
<ul>
<li>Stored in <code>.gemini/commands/</code> at the project root</li>
<li>Only active for that project</li>
<li>Perfect for project-specific checks, deploy flows, or conventions</li>
</ul>
</li>
</ol>
<p>For example, here’s how I use Gemini CLI to <strong>summarize my weekly logs</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># filename: .gemini/commands/weekly.toml</span>
</span></span><span class="line"><span class="cl"><span class="c"># call: /weekly</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">description</span> <span class="p">=</span> <span class="s2">&#34;Summary of the past 7 days&#39; log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">prompt</span> <span class="p">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">Hello, Gemini! I&#39;m reading the journal entries from the past week in the /006-journal directory and summarizing my main activities for the week. I&#39;m also summarizing the files updated in /002-911/bugs for the past week, listing the main problems I solved and the remaining ones.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now I can just type <code>/weekly</code> and Gemini will:</p>
<ul>
<li>read the right folders</li>
<li>summarize my week</li>
<li>list resolved and unresolved issues</li>
</ul>
<p>All without me rewriting a long prompt every time.</p>
<p><img src="https://images.hxzhouh.com/blog-images/2025/12/44b0975dce149e153aa0a9146226a83a.png"
	
	
	
	loading="lazy"
	
		alt="Weekly summary command result"
	
	
></p>
<h3 id="advanced-usage-dynamic-parameters-and-shell-integration">Advanced Usage: Dynamic Parameters and Shell Integration
</h3><p>The real power of Gemini CLI appears when you combine:</p>
<ol>
<li><strong>Dynamic parameters</strong> – capturing extra text after the command</li>
<li><strong>Shell injection with <code>!{cmd}</code></strong> – running system commands and injecting the result into the prompt</li>
</ol>
<h3 id="dynamic-arguments-">Dynamic Arguments: <code>*</code>
</h3><p>Commands can accept dynamic arguments (like “the rest of the line”) so you can write:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/doc:explain api/user.go
</span></span></code></pre></td></tr></table>
</div>
</div><p>and have <code>api/user.go</code> captured and used inside your TOML prompt.</p>
<blockquote>
<p>(The exact placeholder syntax may vary depending on the CLI version; check the Gemini CLI docs for the current spec.)</p></blockquote>
<h3 id="shell-injection-">Shell Injection: <code>!{...}</code>
</h3><p>You can also run system commands directly inside your prompt:</p>
<ul>
<li>
<p><code>!{cmd}</code> will be executed in your shell</p>
</li>
<li>
<p>The command output is injected into the prompt that Gemini sees</p>
</li>
</ul>
<p>This is extremely powerful for <strong>“AI + tooling”</strong> workflows.</p>
<hr>
<h2 id="real-world-example-intelligent-git-commit-message-generator">Real-World Example: Intelligent Git Commit Message Generator
</h2><p>Let’s put it together and build a <strong>Conventional Commits-style commit message generator</strong>.</p>
<p>Create a file: <code>.gemini/commands/git/commit.toml</code><br>
(Commands in subdirectories become namespaced, so you’ll call it as <code>/git:commit</code>.)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># filename: .gemini/commands/git/commit.toml</span>
</span></span><span class="line"><span class="cl"><span class="c"># call: /git:commit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">description</span> <span class="p">=</span> <span class="s2">&#34;Generate a Conventional Commits message from staged changes&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">prompt</span> <span class="p">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">You are a Git expert. Based on the output of `git diff --staged` below, generate a commit message that follows the Conventional Commits specification.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Requirements:
</span></span></span><span class="line"><span class="cl"><span class="s2">1. The first line is a short summary: `&lt;type&gt;: &lt;subject&gt;`.
</span></span></span><span class="line"><span class="cl"><span class="s2">2. Then a blank line.
</span></span></span><span class="line"><span class="cl"><span class="s2">3. Then a detailed list of changes in bullet points.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Diff:
</span></span></span><span class="line"><span class="cl"><span class="s2">!{git diff --staged}
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When you run:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/git:commit
</span></span></code></pre></td></tr></table>
</div>
</div><p>Gemini CLI will:</p>
<ol>
<li>Run <code>git diff --staged</code> in your repo</li>
<li>Inject the diff output into the prompt</li>
<li>Generate a well-structured commit message that follows <strong>Conventional Commits</strong></li>
</ol>
<p>This saves a ton of mental effort every time you commit.</p>
<h3 id="checkpoints-and-rollback-restore-as-a-safety-net">Checkpoints and Rollback: <code>/restore</code> as a Safety Net
</h3><p>When Gemini CLI modifies files, mistakes can happen — both from you and from the model.<br>
That’s where <strong>Checkpointing</strong> and <code>/restore</code> come in.</p>
<h3 id="how-checkpointing-works">How Checkpointing Works
</h3><p>When enabled, Gemini CLI will automatically:</p>
<ul>
<li>Create a <strong>snapshot</strong> of your project files before tools like <code>write_file</code> or <code>replace</code> are executed</li>
<li>Store the snapshot in a <strong>separate Git repository</strong> (it won’t touch your main project repo)</li>
<li>Save the current conversation history and the upcoming tool calls</li>
</ul>
<p>This gives you:</p>
<ul>
<li>A safe “undo” layer independent of your main Git history</li>
<li>The ability to restore both files <strong>and</strong> the conversation context</li>
</ul>
<blockquote>
<p>Note: after you edit the CLI settings, you usually need to restart Gemini CLI for <code>settings.json</code> changes to be picked up.</p></blockquote>
<p>Example settings screen:</p>
<p><img src="https://images.hxzhouh.com/blog-images/2025/12/f1e285fc11be5ed053d800a1f55e6a1d.png"
	
	
	
	loading="lazy"
	
		alt="Gemini CLI checkpoint settings"
	
	
></p>
<h3 id="enabling-checkpointing">Enabling Checkpointing
</h3><p>Checkpointing is controlled via the <code>settings.json</code> file in the Gemini CLI.<br>
Please turn it on there, then restart the CLI once to load the new settings.</p>
<h3 id="restoring-a-checkpoint">Restoring a Checkpoint
</h3><p>Use the <code>/restore</code> command:</p>
<ul>
<li><code>/restore</code>  Lists all available checkpoints</li>
<li><code>/restore [tool_call_id]</code>  Restores to a specific checkpoint</li>
</ul>
<p>Once restored:</p>
<ul>
<li>Your project files are rolled back to the checkpoint state</li>
<li>The CLI conversation history is restored</li>
<li>The original tool call pops back up, so you can decide whether to approve, modify, or cancel it</li>
</ul>
<p>This is incredibly useful when you’re experimenting with big refactors or risky changes and aren’t 100% sure the AI’s suggestion is the best path forward.</p>
<hr>
<h2 id="working-with-multiple-directories-at-once">Working with Multiple Directories at Once
</h2><p>Gemini CLI can also work across <strong>multiple directories</strong> in the same session.<br>
For example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/directory add src/backend,src/frontend,src/shared
</span></span><span class="line"><span class="cl">/directory show  # list all added directories
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Now you can reference them together:
</span></span><span class="line"><span class="cl">@src/backend/api.ts @src/frontend/components.tsx
</span></span><span class="line"><span class="cl">&#34;Make sure backend API types match the frontend component types.&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is perfect for:</p>
<ul>
<li>Keeping backend and frontend contracts in sync</li>
<li>Coordinating shared libraries</li>
<li>Cross-checking changes across multiple modules</li>
</ul>
<p>If you’ve found other interesting patterns or workflows, I’d love to hear about them and discuss them.</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    


    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2025 Copyright © 2023 huizhou92
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
    <script src="/js/adblock-detection.js" defer></script>
     
	
	<div class="busuanzi-footer">
	<span id="busuanzi_container_site_pv">
		Total site visits: <span id="busuanzi_value_site_pv"></span>
	</span>
	<span id="busuanzi_container_site_uv">
		Total Visitors: <span id="busuanzi_value_site_uv"></span>
	</span>
	</div></footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
