<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name="baidu-site-verification" content="codeva-3VTxLtnqFP" /><meta name='description' content="Compare the performance, advantages, and disadvantages of fastjson, gjson, and jsonparser This article delves into the analysis of how the standard library in Go parses JSON and then explores popular JSON parsing libraries, their characteristics, and how they can better assist us in development in different scenarios. This article is first published in the medium MPP plan. If you are a medium user, please follow me on the medium. Thank you very much.">
<meta name="keywords" content="go, json"><title>Analyze various high-performance JSON parsing libraries in Go.</title>

<link rel='canonical' href='https://huizhou92.com/p/analyze-various-high-performance-json-parsing-libraries-in-go./'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="Analyze various high-performance JSON parsing libraries in Go.">
<meta property='og:description' content="Compare the performance, advantages, and disadvantages of fastjson, gjson, and jsonparser This article delves into the analysis of how the standard library in Go parses JSON and then explores popular JSON parsing libraries, their characteristics, and how they can better assist us in development in different scenarios. This article is first published in the medium MPP plan. If you are a medium user, please follow me on the medium. Thank you very much.">
<meta property='og:url' content='https://huizhou92.com/p/analyze-various-high-performance-json-parsing-libraries-in-go./'>
<meta property='og:site_name' content='huizhou92&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='golang' /><meta property='article:published_time' content='2024-06-13T17:10:25&#43;08:00'/><meta property='article:modified_time' content='2024-06-13T17:10:22&#43;08:00'/>
<meta name="twitter:site" content="@https://x.com/piaopiaopig">
    <meta name="twitter:creator" content="@https://x.com/piaopiaopig"><meta name="twitter:title" content="Analyze various high-performance JSON parsing libraries in Go.">
<meta name="twitter:description" content="Compare the performance, advantages, and disadvantages of fastjson, gjson, and jsonparser This article delves into the analysis of how the standard library in Go parses JSON and then explores popular JSON parsing libraries, their characteristics, and how they can better assist us in development in different scenarios. This article is first published in the medium MPP plan. If you are a medium user, please follow me on the medium. Thank you very much.">
    <link rel="shortcut icon" href="/favicon.ico" />

  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-JMPMQ2QREG"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-JMPMQ2QREG');
        }
      </script>
    
  

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9000447749076746"
     crossorigin="anonymous"></script>

<script defer src="https://cloud.umami.is/script.js" data-website-id="e4ee8ffe-fb88-4635-9953-715598461baa"></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu82a0a27be0be6253ef292d06d582a6ab_94926_300x0_resize_q75_box.jpeg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">😄</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">huizhou92&#39;s Blog</a></h1>
            <h2 class="site-description">Backend Engineer With A Focus On Golang, Cloud Computing, Data Storage And Efficiency Tools. Lifelong Learner.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/hxzhouh'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/piaopiaopig'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/newsletter/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>NewsLetter</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://huizhou92.com/" selected>English</option>
                                
                                    <option value="https://huizhou92.com/zh-cn/" >中文</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#json-unmarshal">JSON Unmarshal</a>
          <ol>
            <li><a href="#sub-summary">Sub Summary</a></li>
          </ol>
        </li>
        <li><a href="#fastjsonhttpsgithubcomvalyalafastjson"><a href="https://github.com/valyala/fastjson">fastjson</a></a>
          <ol>
            <li><a href="#analysis">Analysis</a></li>
            <li><a href="#code">Code</a></li>
            <li><a href="#sub-summary-1">Sub Summary</a></li>
          </ol>
        </li>
        <li><a href="#gjsonhttpsgithubcomtidwallgjson"><a href="https://github.com/tidwall/gjson">GJSON</a></a>
          <ol>
            <li><a href="#analysis-1">Analysis</a></li>
            <li><a href="#code-1">Code</a></li>
            <li><a href="#sub-summary-2">Sub Summary</a></li>
            <li><a href="#note">Note</a></li>
            <li><a href="#conclusion">Conclusion</a></li>
          </ol>
        </li>
        <li><a href="#jsonparserhttpsgithubcombugerjsonparser"><a href="https://github.com/buger/jsonparser">jsonparser</a></a>
          <ol>
            <li><a href="#analysis-2">Analysis</a></li>
            <li><a href="#sub-summary-3">Sub Summary</a></li>
          </ol>
        </li>
        <li><a href="#performance-comparison">Performance Comparison</a>
          <ol>
            <li><a href="#parsing-small-json-strings">Parsing Small JSON Strings</a></li>
            <li><a href="#parsing-medium-json-strings">Parsing Medium JSON Strings</a></li>
            <li><a href="#parsing-large-json-strings">Parsing Large JSON Strings</a></li>
          </ol>
        </li>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#reference">Reference</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/tech/" style="background-color: #2a9d8f; color: #ffff;">
                tech
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/analyze-various-high-performance-json-parsing-libraries-in-go./">Analyze various high-performance JSON parsing libraries in Go.</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 13, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    15 minute read
                </time>
            </div>
        
         
        <div class="article-analysic">&nbsp
    
            <?xml version="1.0" encoding="utf-8"?>

<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg fill="#000000" width="800px" height="800px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  
  <g id="read">
    <g>
      <path  d="M12,18.883a10.8,10.8,0,0,1-9.675-5.728,2.6,2.6,0,0,1,0-2.31A10.8,10.8,0,0,1,12,5.117a10.8,10.8,0,0,1,9.675,5.728h0a2.6,2.6,0,0,1,0,2.31A10.8,10.8,0,0,1,12,18.883ZM12,6.117a9.787,9.787,0,0,0-8.78,5.176,1.586,1.586,0,0,0,0,1.415A9.788,9.788,0,0,0,12,17.883a9.787,9.787,0,0,0,8.78-5.176,1.584,1.584,0,0,0,0-1.414h0A9.787,9.787,0,0,0,12,6.117Z"/>
      <path  d="M12,16.049A4.049,4.049,0,1,1,16.049,12,4.054,4.054,0,0,1,12,16.049Zm0-7.1A3.049,3.049,0,1,0,15.049,12,3.052,3.052,0,0,0,12,8.951Z"/>
      <circle  cx="12" cy="12" r="2.028"/>
    </g>
  </g>
</svg>
            <time class="article-words">
                <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span> &nbspReads</span>
            </time>
        </div>
    </footer>
    

    
        <footer class="article-translations">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



            <div>
                
                    <a href="https://huizhou92.com/zh-cn/p/%E6%B7%B1%E5%85%A5-go-%E4%B8%AD%E5%90%84%E4%B8%AA%E9%AB%98%E6%80%A7%E8%83%BD-json-%E8%A7%A3%E6%9E%90%E5%BA%93/" class="link">中文</a>
                
            </div>
        </footer>
    
</div>

</header>

    <section class="article-content">
    
    
    <p>Compare the performance, advantages, and disadvantages of <code>fastjson</code>, <code>gjson</code>, and <code>jsonparser</code></p>
<p>This article delves into the analysis of how the standard library in Go parses JSON and then explores popular JSON parsing libraries, their characteristics, and how they can better assist us in development in different scenarios.</p>
<!-- more-->
<blockquote>
<p>This article is first published in the medium MPP plan. If you are a medium user, please follow me on the <a class="link" href="https://medium.huizhou92.com/"  target="_blank" rel="noopener"
    >medium</a>. Thank you very much.</p>
</blockquote>
<p>I didn&rsquo;t plan to look into the JSON library&rsquo;s performance issue. However, recently, I did a pprof on my project and found from the flame graph below that more than half of the performance consumption in business logic processing is during JSON parsing. Therefore, this article came about.</p>
<p><img src="https://images.hxzhouh.com/blog-images/2024/06/350348b7bfe6aaec853676d44ca04beb.png"
	
	
	
	loading="lazy"
	
		alt="image-20210519160937326"
	
	
></p>
<p>This article delves into the analysis of how the standard library in Go parses JSON and then explores popular JSON parsing libraries, as well as their characteristics and how they can better assist us in development in different scenarios.</p>
<p>Mainly introduce the analysis of the following libraries (2024-06-13):</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>lib</th>
<th>Star</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON Unmarshal</td>
<td></td>
</tr>
<tr>
<td>valyala/fastjson</td>
<td>2.2 k</td>
</tr>
<tr>
<td>tidwall/gjson</td>
<td>13.8 k</td>
</tr>
<tr>
<td>buger/jsonparser</td>
<td>5.4 k</td>
</tr>
</tbody>
</table></div>
<h3 id="json-unmarshal">JSON Unmarshal
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Unmarshal</span><span class="p">(</span><span class="nx">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>&ldquo;The official JSON parsing library requires two parameters: the object to be serialized and the type of this object. Before actually performing JSON parsing, <code>reflect.ValueOf</code> is called to obtain the reflection object of parameter <code>v</code>. Then, the method for parsing is determined based on the non-empty characters at the beginning of the incoming data object.&rdquo;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">d</span> <span class="o">*</span><span class="nx">decodeState</span><span class="p">)</span> <span class="nf">value</span><span class="p">(</span><span class="nx">v</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="nx">d</span><span class="p">.</span><span class="nx">opcode</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">panic</span><span class="p">(</span><span class="nx">phasePanicMsg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// array 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">case</span> <span class="nx">scanBeginArray</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// struct or map
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">case</span> <span class="nx">scanBeginObject</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Literals, including int, string, float, etc.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">case</span> <span class="nx">scanBeginLiteral</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If the parsed object starts with <code>[</code>, it indicates that this is an array object and will enter the scanBeginArray branch; if it starts with <code>{</code>, it indicates that the parsed object is a struct or map, and then enters the scanBeginObject branch, and so on.</p>
<h4 id="sub-summary">Sub Summary
</h4><p>Looking at Unmarshal&rsquo;s source code, it can be seen that a large amount of reflection is used to obtain field values. If the JSON is nested, recursive reflection is needed to obtain values. Thus, the performance can be imagined to be very poor.</p>
<p>However, if performance is not highly valued, using it directly is actually a very good choice. It has complete functionality, and the official team has been continuously iterating and optimizing it. Maybe its performance will also make a qualitative leap in future versions. It should be the only one that can directly convert JSON objects into Go structs.</p>
<h3 id="fastjsonhttpsgithubcomvalyalafastjson"><a class="link" href="https://github.com/valyala/fastjson"  target="_blank" rel="noopener"
    >fastjson</a>
</h3><p>The characteristic of this library is fast, just like its name suggests. Its introduction page says so:</p>
<blockquote>
<p>Fast. As usual, up to 15x faster than the standard encoding/json.</p>
</blockquote>
<p>Its usage is also very simple, as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">p</span> <span class="nx">fastjson</span><span class="p">.</span><span class="nx">Parser</span>
</span></span><span class="line"><span class="cl">    <span class="nx">v</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">p</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">`{
</span></span></span><span class="line"><span class="cl"><span class="s">                &#34;str&#34;: &#34;bar&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s">                &#34;int&#34;: 123,
</span></span></span><span class="line"><span class="cl"><span class="s">                &#34;float&#34;: 1.23,
</span></span></span><span class="line"><span class="cl"><span class="s">                &#34;bool&#34;: true,
</span></span></span><span class="line"><span class="cl"><span class="s">                &#34;arr&#34;: [1, &#34;foo&#34;, {}]
</span></span></span><span class="line"><span class="cl"><span class="s">        }`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;foo=%s\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nf">GetStringBytes</span><span class="p">(</span><span class="s">&#34;str&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;int=%d\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nf">GetInt</span><span class="p">(</span><span class="s">&#34;int&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;float=%f\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nf">GetFloat64</span><span class="p">(</span><span class="s">&#34;float&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;bool=%v\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nf">GetBool</span><span class="p">(</span><span class="s">&#34;bool&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;arr.1=%s\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nf">GetStringBytes</span><span class="p">(</span><span class="s">&#34;arr&#34;</span><span class="p">,</span> <span class="s">&#34;1&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Output:
</span></span></span><span class="line"><span class="cl"><span class="c1">// foo=bar
</span></span></span><span class="line"><span class="cl"><span class="c1">// int=123
</span></span></span><span class="line"><span class="cl"><span class="c1">// float=1.230000
</span></span></span><span class="line"><span class="cl"><span class="c1">// bool=true
</span></span></span><span class="line"><span class="cl"><span class="c1">// arr.1=foo
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>To use fastjson, first, give the JSON string to the Parser parser for parsing, and then retrieve it through the object returned by the Parse method. If it is a nested object, you can directly pass in the corresponding parent-child key when passing parameters to the Get method.</p>
<h4 id="analysis">Analysis
</h4><p>The design of <code>fastjson</code> differs from the standard library <code>Unmarshal</code> in that it divides JSON parsing into two parts: Parse and Get.</p>
<p>Parse is responsible for parsing the JSON string into a structure and returning it. Data is then retrieved from the returned structure. The Parse process is lock-free, so if you want to call Parse concurrently, you need to use ParserPool.</p>
<p><code>fastjson</code> processes JSON by traversing it from top to bottom, storing the parsed data in a <code>Value</code> structure:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Value</span> <span class="kd">struct</span> <span class="p">{</span> <span class="nx">o</span> <span class="nx">Object</span> <span class="nx">a</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Value</span> <span class="nx">s</span> <span class="kt">string</span> <span class="nx">t</span> <span class="nx">Type</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This structure is very simple:</p>
<ul>
<li><code>o Object</code>: Indicates that the parsed structure is an object.</li>
<li><code>a []*Value</code>: Indicates that the parsed structure is an array.</li>
<li><code>s string</code>: If the parsed structure is neither an object nor an array, other types of values are stored in this field as a string.</li>
<li><code>t Type</code>: Represents the type of this structure, which can be TypeObject, TypeArray, TypeString, TypeNumber, etc.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Object</span> <span class="kd">struct</span> <span class="p">{</span> <span class="nx">kvs</span> <span class="p">[]</span><span class="nx">kv</span> <span class="nx">keysUnescaped</span> <span class="kt">bool</span> <span class="p">}</span> <span class="kd">type</span> <span class="nx">kv</span> <span class="kd">struct</span> <span class="p">{</span> <span class="nx">k</span> <span class="kt">string</span> <span class="nx">v</span> <span class="o">*</span><span class="nx">Value</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This structure stores the recursive structure of objects. After parsing the JSON string in the example above, the resulting structure looks like this:</p>
<p><img src="https://images.hxzhouh.com/blog-images/2024/06/f14ac18535d8ad2d963fb0c08bcb879f.png"
	
	
	
	loading="lazy"
	
		alt="fastjson"
	
	
></p>
<h4 id="code">Code
</h4><p>In terms of implementation, the absence of reflection code makes the entire parsing process very clean. Let&rsquo;s directly look at the main part of the parsing:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">parseValue</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">c</span> <span class="o">*</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">depth</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="nx">Value</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;cannot parse empty string&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">depth</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// The maximum depth of the json string cannot exceed MaxDepth
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">depth</span> <span class="p">&gt;</span> <span class="nx">MaxDepth</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;too big depth for the nested JSON; it exceeds %d&#34;</span><span class="p">,</span> <span class="nx">MaxDepth</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// parse object
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;{&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">v</span><span class="p">,</span> <span class="nx">tail</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">parseObject</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">tail</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;cannot parse object: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">tail</span><span class="p">,</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// parse array
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;[&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// parse string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;&#34;&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">tail</span><span class="p">,</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>parseValue will determine the type to be parsed based on the first non-empty character of the string. Here, an object type is used for parsing:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">parseObject</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">c</span> <span class="o">*</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">depth</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="nx">Value</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nf">getValue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span><span class="p">.</span><span class="nx">t</span> <span class="p">=</span> <span class="nx">TypeObject</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nf">reset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">err</span> <span class="kt">error</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 获取Ojbect结构体中的 kv 对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">kv</span> <span class="o">:=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">o</span><span class="p">.</span><span class="nf">getKV</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span> 
</span></span><span class="line"><span class="cl">        <span class="c1">// 解析 key 值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="nx">kv</span><span class="p">.</span><span class="nx">k</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nf">parseRawKey</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span> 
</span></span><span class="line"><span class="cl">        <span class="c1">// 递归解析 value 值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">kv</span><span class="p">.</span><span class="nx">v</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nf">parseValue</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 遇到 ，号继续往下解析
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;,&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">s</span> <span class="p">=</span> <span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 解析完毕
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;}&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;missing &#39;,&#39; after object value&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The parseObject function is also very simple. It will get the key value in the loop, and then call the parseValue function recursively to parse the value from top to bottom, parsing JSON objects one by one until encountering <code>}</code> at last.</p>
<h4 id="sub-summary-1">Sub Summary
</h4><p>Through the above analysis, it can be seen that <code>fastjson</code> is much simpler in implementation and has higher performance than the standard library. After using Parse to parse the JSON tree, it can be reused multiple times, avoiding the need for repeated parsing and improving performance.</p>
<p>However, its functionality is very rudimentary and lacks common operations such as JSON to struct or JSON to map conversion. If you only want to simply retrieve values from JSON, then using this library is very convenient. But if you want to convert JSON values into a structure, you will need to manually set each value yourself.</p>
<h3 id="gjsonhttpsgithubcomtidwallgjson"><a class="link" href="https://github.com/tidwall/gjson"  target="_blank" rel="noopener"
    >GJSON</a>
</h3><p>In my test, although the performance of GJSON is not as extreme as fastjson, its functionality is very complete and its performance is also quite OK. Next, let me briefly introduce the functionality of GJSON.</p>
<p>The usage of GJSON is similar to fastjson, it is also very simple. Just pass in the JSON string and the value that needs to be obtained as parameters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">json</span> <span class="o">:=</span> <span class="s">`{&#34;name&#34;:{&#34;first&#34;:&#34;li&#34;,&#34;last&#34;:&#34;dj&#34;},&#34;age&#34;:18}`</span>
</span></span><span class="line"><span class="cl"><span class="nx">lastName</span> <span class="o">:=</span> <span class="nx">gjson</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="s">&#34;name.last&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In addition to this function, simple fuzzy matching can also be performed. It supports wildcard characters <code>*</code> and <code>?</code> in the key. <code>*</code> matches any number of characters, while <code>?</code> matches a single character, as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">json</span> <span class="o">:=</span> <span class="s">`{
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;name&#34;:{&#34;first&#34;:&#34;Tom&#34;, &#34;last&#34;: &#34;Anderson&#34;},
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;age&#34;: 37,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;children&#34;: [&#34;Sara&#34;, &#34;Alex&#34;, &#34;Jack&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">}`</span>
</span></span><span class="line"><span class="cl"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;third child*:&#34;</span><span class="p">,</span> <span class="nx">gjson</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="s">&#34;child*.2&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first c?ild:&#34;</span><span class="p">,</span> <span class="nx">gjson</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="s">&#34;c?ildren.0&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>child*.2</code>: First, <code>child*</code> matches <code>children</code>, <code>.2</code> reads the third element;</li>
<li><code>c?ildren.0</code>: <code>c?ildren</code> matches <code>children</code>, <code>.0</code> reads the first element;</li>
</ul>
<p>In addition to fuzzy matching, it also supports modifier operations.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">json</span> <span class="o">:=</span> <span class="s">`{
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;name&#34;:{&#34;first&#34;:&#34;Tom&#34;, &#34;last&#34;: &#34;Anderson&#34;},
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;age&#34;: 37,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;children&#34;: [&#34;Sara&#34;, &#34;Alex&#34;, &#34;Jack&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">}`</span>
</span></span><span class="line"><span class="cl"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;third child*:&#34;</span><span class="p">,</span> <span class="nx">gjson</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="s">&#34;children|@reverse&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>children|@reverse</code> 先读取数组<code>children</code>，然后使用修饰符<code>@reverse</code>翻转之后返回，输出。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">nestedJSON</span> <span class="o">:=</span> <span class="s">`{&#34;nested&#34;: [&#34;one&#34;, &#34;two&#34;, [&#34;three&#34;, &#34;four&#34;]]}`</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">gjson</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">nestedJSON</span><span class="p">,</span> <span class="s">&#34;nested|@flatten&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>@flatten</code> flattens the inner array of array <code>nested</code> to the outer array and returns:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span><span class="s2">&#34;one,&#34;</span> <span class="s2">&#34;two,&#34;</span> <span class="s2">&#34;three,&#34;</span> <span class="s2">&#34;four&#34;</span><span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There are some other interesting features, you can check the official documentation.</p>
<h4 id="analysis-1">Analysis
</h4><p>The Get method parameter of GJSON is composed of two parts, one is a JSON string, and the other is called Path, which represents the matching path of the JSON value to be obtained.</p>
<p>In GJSON, because it needs to meet many definitions of parsing scenarios, the parsing is divided into two parts. You need to parse the Path before traversing the JSON string.</p>
<p>If you encounter a value that can be matched during the parsing process, it will be returned directly, and there is no need to continue to traverse down. If multiple values are matched, the whole JSON string will be traversed all the time. If you encounter a Path that cannot be matched in the JSON string, you also need to traverse the complete JSON string.</p>
<p>In the process of parsing, the content of parsing will not be saved in a structure like fastjson, which can be used repeatedly. So when you call GetMany to return multiple values, you actually need to traverse the JSON string many times, so the efficiency will be relatively low.</p>
<p><img src="https://images.hxzhouh.com/blog-images/2024/06/cbf3e20a3fc56830e27a147df315e2d1.png"
	
	
	
	loading="lazy"
	
		alt="Pasted image 20240613165903"
	
	
></p>
<p>It&rsquo;s important to be aware that when using the @flatten function to parse JSON, it won&rsquo;t be validated. This means that even if the input string is not a valid JSON, it will still be parsed. Therefore, it&rsquo;s essential for users to double-check that the input is indeed a valid JSON to avoid any potential issues.</p>
<h4 id="code-1">Code
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Get</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">Result</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 解析 path 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">i</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">c</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">parseContext</span><span class="p">{</span><span class="nx">json</span><span class="p">:</span> <span class="nx">json</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;.&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">path</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;.&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">c</span><span class="p">.</span><span class="nx">lines</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nf">parseArray</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">path</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Parse according to different objects, and loop here until &#39;{&#39; or &#39;[&#39; is found
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;{&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">i</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nf">parseObject</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;[&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">i</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">                <span class="nf">parseArray</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">piped</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">pipe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span><span class="p">.</span><span class="nx">Index</span> <span class="p">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">res</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fillIndex</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">value</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the Get method, you can see a long code string used to parse various paths. Then, a for loop continuously traverses JSON until it finds &lsquo;{&rsquo; or &lsquo;[&rsquo; before performing the corresponding logic processing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">parseObject</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">parseContext</span><span class="p">,</span> <span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">pmatch</span><span class="p">,</span> <span class="nx">kesc</span><span class="p">,</span> <span class="nx">vesc</span><span class="p">,</span> <span class="nx">ok</span><span class="p">,</span> <span class="nx">hit</span> <span class="kt">bool</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">val</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">    <span class="nx">rp</span> <span class="o">:=</span> <span class="nf">parseObjectPath</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">!</span><span class="nx">rp</span><span class="p">.</span><span class="nx">more</span> <span class="o">&amp;&amp;</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">piped</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">c</span><span class="p">.</span><span class="nx">pipe</span> <span class="p">=</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">pipe</span>
</span></span><span class="line"><span class="cl">        <span class="nx">c</span><span class="p">.</span><span class="nx">piped</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Nest two for loops to find the key value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;&#34;&#39;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">                <span class="nx">i</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">                <span class="kd">var</span> <span class="nx">s</span> <span class="p">=</span> <span class="nx">i</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">&gt;</span> <span class="sc">&#39;\\&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// Find the key value and jump to parse_key_string_done
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;&#34;&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">i</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">kesc</span><span class="p">,</span> <span class="nx">ok</span> <span class="p">=</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">s</span><span class="p">:</span><span class="nx">i</span><span class="p">],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                        <span class="k">goto</span> <span class="nx">parse_key_string_done</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">...</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nx">key</span><span class="p">,</span> <span class="nx">kesc</span><span class="p">,</span> <span class="nx">ok</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">s</span><span class="p">:],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// break
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">parse_key_string_done</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;}&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">!</span><span class="nx">ok</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Check whether it is a fuzzy match
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">wild</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">kesc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pmatch</span> <span class="p">=</span> <span class="nx">match</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="nf">unescape</span><span class="p">(</span><span class="nx">key</span><span class="p">),</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">part</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pmatch</span> <span class="p">=</span> <span class="nx">match</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">part</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">kesc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pmatch</span> <span class="p">=</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">part</span> <span class="o">==</span> <span class="nf">unescape</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pmatch</span> <span class="p">=</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">part</span> <span class="o">==</span> <span class="nx">key</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// parse value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">hit</span> <span class="p">=</span> <span class="nx">pmatch</span> <span class="o">&amp;&amp;</span> <span class="p">!</span><span class="nx">rp</span><span class="p">.</span><span class="nx">more</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">switch</span> <span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="sc">&#39;&#34;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nx">i</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">                <span class="nx">i</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">vesc</span><span class="p">,</span> <span class="nx">ok</span> <span class="p">=</span> <span class="nf">parseString</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">!</span><span class="nx">ok</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nx">hit</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nx">vesc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Str</span> <span class="p">=</span> <span class="nf">unescape</span><span class="p">(</span><span class="nx">val</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Str</span> <span class="p">=</span> <span class="nx">val</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Raw</span> <span class="p">=</span> <span class="nx">val</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Type</span> <span class="p">=</span> <span class="nx">String</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="sc">&#39;{&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nx">pmatch</span> <span class="o">&amp;&amp;</span> <span class="p">!</span><span class="nx">hit</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">i</span><span class="p">,</span> <span class="nx">hit</span> <span class="p">=</span> <span class="nf">parseObject</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">rp</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nx">hit</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">i</span><span class="p">,</span> <span class="nx">val</span> <span class="p">=</span> <span class="nf">parseSquash</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">json</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nx">hit</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Raw</span> <span class="p">=</span> <span class="nx">val</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">Type</span> <span class="p">=</span> <span class="nx">JSON</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">i</span><span class="p">,</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In reviewing the <code>parseObject</code> code, the intention was not to teach JSON parsing or string traversal but to illustrate a bad-case scenario. The nested <code>for</code> loops and consecutive <code>if</code> statements can be overwhelming and may remind you of a colleague&rsquo;s code you&rsquo;ve encountered at work.</p>
<h4 id="sub-summary-2">Sub Summary
</h4><p><strong>Advantages:</strong></p>
<ol>
<li><strong>Performance:</strong> <code>jsonparser</code> performs relatively well compared to the standard library.</li>
<li><strong>Flexibility:</strong> It offers various retrieval methods and customizable return values, making it very convenient.</li>
</ol>
<p><strong>Disadvantages:</strong></p>
<ol>
<li><strong>No JSON Validation:</strong> It does not check for the correctness of the JSON input.</li>
<li><strong>Code Smell:</strong> The code structure is cumbersome and hard to read, which can make maintenance challenging.</li>
</ol>
<h4 id="note">Note
</h4><p>When parsing JSON to retrieve values, the <code>GetMany</code> function will traverse the JSON string multiple times based on the specified keys. Converting the JSON to a map can reduce the number of traversals.</p>
<h4 id="conclusion">Conclusion
</h4><p>While <code>jsonparser</code> has notable performance and flexibility, its lack of JSON validation and complex, hard-to-read code structure present significant drawbacks. If you need to parse JSON and retrieve values frequently, consider the trade-offs between performance and code maintainability.</p>
<h3 id="jsonparserhttpsgithubcombugerjsonparser"><a class="link" href="https://github.com/buger/jsonparser"  target="_blank" rel="noopener"
    >jsonparser</a>
</h3><h4 id="analysis-2">Analysis
</h4><p><code>jsonparser</code> also processes an input JSON byte slice and allows for quickly locating and returning values by passing multiple keys.</p>
<p>Similar to GJSON, <code>jsonparser</code> does not cache the parsed JSON string in a data structure as <code>fastjson</code> does. However, when multiple values need to be parsed, the <code>EachKey</code> function can be used to parse multiple values in a single pass through the JSON string.</p>
<p>If a matching value is found, <code>jsonparser</code> returns immediately without further traversal. For multiple matches, it traverses the entire JSON string. If a path does not match any value in the JSON string, it still traverses the entire string.</p>
<p><code>jsonparser</code> reduces the use of recursion by employing loops during JSON traversal, thus decreasing the call stack depth and enhancing performance.</p>
<p>In terms of functionality, <code>ArrayEach</code>, <code>ObjectEach</code>, and <code>EachKey</code> functions allow for passing a custom function to meet specific needs, greatly enhancing the utility of <code>jsonparser</code>.</p>
<p>The code for <code>jsonparser</code> is straightforward and clear, making it easy to analyze. Those interested can examine it themselves.</p>
<h4 id="sub-summary-3">Sub Summary
</h4><p>The high performance of <code>jsonparser</code> compared to the standard library can be attributed to:</p>
<ol>
<li>Using <code>for</code> loops to minimize recursion.</li>
<li>Avoid the use of reflection, unlike the standard library.</li>
<li>Exiting immediately upon finding the corresponding key value without further recursion.</li>
<li>Operating on the passed-in JSON string without allocating new space, thus reducing memory allocations.</li>
</ol>
<p>Additionally, the API design is highly practical. Functions like <code>ArrayEach</code>, <code>ObjectEach</code>, and <code>EachKey</code> allow for passing custom functions, solving many issues in actual business development.</p>
<p>However, <code>jsonparser</code> has a significant drawback: it does not validate JSON. If the input is not valid JSON, <code>jsonparser</code> will not detect it.</p>
<h3 id="performance-comparison">Performance Comparison
</h3><h4 id="parsing-small-json-strings">Parsing Small JSON Strings
</h4><p>Parsing a simple JSON string of approximately 190 bytes</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Library</th>
<th>Operation</th>
<th>Time per Iteration</th>
<th>Memory Usage</th>
<th>Memory Allocations</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard Library</td>
<td>Parse to map</td>
<td>724 ns/op</td>
<td>976 B/op</td>
<td>51 allocs/op</td>
<td>Slow</td>
</tr>
<tr>
<td></td>
<td>Parse to struct</td>
<td>297 ns/op</td>
<td>256 B/op</td>
<td>5 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td>fastjson</td>
<td>get</td>
<td>68.2 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fastest</td>
</tr>
<tr>
<td></td>
<td>parse</td>
<td>35.1 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fastest</td>
</tr>
<tr>
<td>GJSON</td>
<td>Convert to map</td>
<td>255 ns/op</td>
<td>1009 B/op</td>
<td>11 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td></td>
<td>get</td>
<td>232 ns/op</td>
<td>448 B/op</td>
<td>1 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td>jsonparser</td>
<td>get</td>
<td>106 ns/op</td>
<td>232 B/op</td>
<td>3 allocs/op</td>
<td>Fast</td>
</tr>
</tbody>
</table></div>
<h4 id="parsing-medium-json-strings">Parsing Medium JSON Strings
</h4><p>Parsing a JSON string of moderate complexity, approximately 2.3KB</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Library</th>
<th>Operation</th>
<th>Time per Iteration</th>
<th>Memory Usage</th>
<th>Memory Allocations</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard Library</td>
<td>Parse to map</td>
<td>4263 ns/op</td>
<td>10212 B/op</td>
<td>208 allocs/op</td>
<td>Slow</td>
</tr>
<tr>
<td></td>
<td>Parse to struct</td>
<td>4789 ns/op</td>
<td>9206 B/op</td>
<td>259 allocs/op</td>
<td>Slow</td>
</tr>
<tr>
<td>fastjson</td>
<td>get</td>
<td>285 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fastest</td>
</tr>
<tr>
<td></td>
<td>parse</td>
<td>302 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fastest</td>
</tr>
<tr>
<td>GJSON</td>
<td>Convert to map</td>
<td>2571 ns/op</td>
<td>8539 B/op</td>
<td>83 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td></td>
<td>get</td>
<td>1489 ns/op</td>
<td>448 B/op</td>
<td>1 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td>jsonparser</td>
<td>get</td>
<td>878 ns/op</td>
<td>2728 B/op</td>
<td>5 allocs/op</td>
<td>Fast</td>
</tr>
</tbody>
</table></div>
<h4 id="parsing-large-json-strings">Parsing Large JSON Strings
</h4><p>Parsing a JSON string of high complexity, approximately 2.2MB</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Library</th>
<th>Operation</th>
<th>Time per Iteration</th>
<th>Memory Usage</th>
<th>Memory Allocations</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard Library</td>
<td>Parse to map</td>
<td>2292959 ns/op</td>
<td>5214009 B/op</td>
<td>95402 allocs/op</td>
<td>Slow</td>
</tr>
<tr>
<td></td>
<td>Parse to struct</td>
<td>1165490 ns/op</td>
<td>2023 B/op</td>
<td>76 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td>fastjson</td>
<td>get</td>
<td>368056 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fast</td>
</tr>
<tr>
<td></td>
<td>parse</td>
<td>371397 ns/op</td>
<td>0 B/op</td>
<td>0 allocs/op</td>
<td>Fast</td>
</tr>
<tr>
<td>GJSON</td>
<td>Convert to map</td>
<td>1901727 ns/op</td>
<td>4788894 B/op</td>
<td>54372 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td></td>
<td>get</td>
<td>1322167 ns/op</td>
<td>448 B/op</td>
<td>1 allocs/op</td>
<td>Average</td>
</tr>
<tr>
<td>jsonparser</td>
<td>get</td>
<td>233090 ns/op</td>
<td>1788865 B/op</td>
<td>376 allocs/op</td>
<td>Fastest</td>
</tr>
</tbody>
</table></div>
<h3 id="summary">Summary
</h3><p>During this comparison, I analyzed several high-performance JSON parsing libraries. It was evident that these libraries share several common characteristics:</p>
<ul>
<li>They avoid using reflection.</li>
<li>They parse JSON by traversing the bytes of the JSON string sequentially.</li>
<li>They minimize memory allocation by directly parsing the input JSON string.</li>
<li>They sacrifice some compatibility for performance.</li>
</ul>
<p>Despite these trade-offs, each library offers unique features. The <code>fastjson</code> API is the simplest to use; GJSON offers fuzzy searching capabilities and high customizability; <code>jsonparser</code> supports inserting callback functions during high-performance parsing, providing a degree of convenience.</p>
<p>For my use case, which involves simply parsing certain fields from HTTP response JSON strings with predetermined fields and occasional custom operations, <code>jsonparser</code> is the most suitable tool.</p>
<p>Therefore, if performance concerns you, consider selecting a JSON parser based on your business requirements.</p>
<h3 id="reference">Reference
</h3><p><a class="link" href="https://github.com/buger/jsonparser"  target="_blank" rel="noopener"
    >https://github.com/buger/jsonparser</a><br>
<a class="link" href="https://github.com/tidwall/gjson"  target="_blank" rel="noopener"
    >https://github.com/tidwall/gjson</a><br>
<a class="link" href="https://github.com/valyala/fastjson"  target="_blank" rel="noopener"
    >https://github.com/valyala/fastjson</a><br>
<a class="link" href="https://github.com/json-iterator/go"  target="_blank" rel="noopener"
    >https://github.com/json-iterator/go</a><br>
<a class="link" href="https://github.com/mailru/easyjson"  target="_blank" rel="noopener"
    >https://github.com/mailru/easyjson</a><br>
<a class="link" href="https://github.com/Jeffail/gabs"  target="_blank" rel="noopener"
    >https://github.com/Jeffail/gabs</a><br>
<a class="link" href="https://github.com/bitly/go-simplejson"  target="_blank" rel="noopener"
    >https://github.com/bitly/go-simplejson</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/golang/">Golang</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Jun 13, 2024 17:10 CST
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/performance-profiling-of-golangs-biggest-killers-pprof/">
        
        

        <div class="article-details">
            <h2 class="article-title">Performance Profiling of Golang&#39;s Biggest Killers: PProf</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/how-to-analyze-go-code-in-assembly/">
        
        

        <div class="article-details">
            <h2 class="article-title">How to analyze Go code in assembly</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/golang-vs-node/">
        
        
            <div class="article-image">
                
                    <img src="https://images.hxzhouh.com/blog-images/2024/03/19f465a70b3b13a1bcf9d608bb5d5f3f.jpeg" loading="lazy" data-key="" data-hash="https://images.hxzhouh.com/blog-images/2024/03/19f465a70b3b13a1bcf9d608bb5d5f3f.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Golang vs node</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/decryption-gogoroutine-state-switching/">
        
        
            <div class="article-image">
                
                    <img src="https://images.hxzhouh.com/blog-images/2024/04/47e76a58f390d2e7740aacfbff0a328b.jpg" loading="lazy" data-key="" data-hash="https://images.hxzhouh.com/blog-images/2024/04/47e76a58f390d2e7740aacfbff0a328b.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">decryption go：goroutine state switching</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/decrypt-go-panic-and-recover/">
        
        
            <div class="article-image">
                
                    <img src="https://images.hxzhouh.com/blog-images/2024/02/1301d7769a1515085fa143e709975d83.png" loading="lazy" data-key="" data-hash="https://images.hxzhouh.com/blog-images/2024/02/1301d7769a1515085fa143e709975d83.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Decrypt Go: Panic and Recover</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="//cdn.jsdelivr.net/npm/twikoo@1.6.21/dist/twikoo.all.min.js"></script>
<div id="tcomment"></div>
<style>
    .twikoo {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
    :root[data-scheme="dark"] {
        --twikoo-body-text-color-main: rgba(255, 255, 255, 0.9);
        --twikoo-body-text-color: rgba(255, 255, 255, 0.7);
    }
    .twikoo .el-input-group__prepend,
    .twikoo .tk-action-icon,
    .twikoo .tk-submit-action-icon,
    .twikoo .tk-time,
    .twikoo .tk-comments-no,
    .twikoo .tk-comments-count {
        color: var(--twikoo-body-text-color);
    }
    .twikoo .el-input__inner,
    .twikoo .el-textarea__inner,
    .twikoo .tk-preview-container,
    .twikoo .tk-content,
    .twikoo .tk-nick,
    .twikoo .tk-send {
        color: var(--twikoo-body-text-color-main);
    }
    .twikoo .el-button{
        color: var(--twikoo-body-text-color)!important;
    }
    .twikoo .el-input__count {
        color: var(--twikoo-body-text-color) !important;
    }
    .OwO .OwO-body {
        background-color: var(--body-background) !important;
        color: var(--body-text-color) !important;
    }
</style><script>
    twikoo.init({
        envId: 'https:\/\/twikoo.yixiao9206.cn',
        el: '#tcomment',lang: 'en',})
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 Copyright © 2023 huizhou92
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
    
     	
	
	<div class="busuanzi-footer">
	<span id="busuanzi_container_site_pv">
		Total site visits: <span id="busuanzi_value_site_pv"></span>
	</span>
	<span id="busuanzi_container_site_uv">
		Total Visitors: <span id="busuanzi_value_site_uv"></span>
	</span>
	</div></footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
