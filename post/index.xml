<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on huizhou92&#39;s Blog</title>
        <link>https://huizhou92.com/post/</link>
        <description>Recent content in Posts on huizhou92&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <copyright>Copyright © 2023 huizhou92</copyright>
        <lastBuildDate>Tue, 06 Jan 2026 14:59:24 +0800</lastBuildDate><atom:link href="https://huizhou92.com/post/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>10 Quiet Side Projects Making Real Money in 2025</title>
        <link>https://huizhou92.com/p/10-quiet-side-projects-making-real-money-in-2025/</link>
        <pubDate>Thu, 25 Dec 2025 09:53:08 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/10-quiet-side-projects-making-real-money-in-2025/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/12/e12f373d8b6bc29b61eca52a61feacc1.png" alt="Featured image of post 10 Quiet Side Projects Making Real Money in 2025" /&gt;&lt;p&gt;While everyone on Twitter is chasing the next AI wrapper or prompt marketplace, a post on &lt;strong&gt;Hacker News&lt;/strong&gt; asked a much more grounded question:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;If you’re making more than $500/month from a side project in 2025, what are you building?&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The answers were refreshing.&lt;/p&gt;
&lt;p&gt;No hype.&lt;br&gt;
No “AI will change everything” slogans.&lt;br&gt;
Just &lt;strong&gt;small, specific problems solved well&lt;/strong&gt;—often in niches most of us never think about.&lt;/p&gt;
&lt;p&gt;I picked &lt;strong&gt;10 of the most interesting projects&lt;/strong&gt; from that thread.&lt;br&gt;
If you’re feeling burned out by endless AI discourse, this might help reset your brain.&lt;/p&gt;
&lt;!-- more--&gt;
&lt;h2 id=&#34;1-a-printable-escape-room-you-can-play-at-home&#34;&gt;1. A Printable “Escape Room” You Can Play at Home
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://www.escape-team.com/media/pages/free-escape-room-diy-kit/b9b14b0aec-1714919456/cursor-and-instant-escape-room-kit-pdf-33-33-cmyk-preview.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/12/c6356e4f549a9ccf01fc210f49373dcd.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Pasted image 20251224224319&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Instead of building a physical escape room, this project sells &lt;strong&gt;downloadable PDF escape games&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Users buy a script, print it, cut it out, and use a companion app to play puzzles at home—perfect for parties or family gatherings.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~$1,000&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://www.escape-team.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.escape-team.com/&lt;/a&gt;&lt;br&gt;
&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Digital distribution + physical interaction = low cost, high perceived value.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-managing-xbox-consoles-in-childrens-hospitals&#34;&gt;2. Managing Xbox Consoles in Children’s Hospitals
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://i0.wp.com/childlifemommy.com/wp-content/uploads/2020/01/FullyLoaded1.png?ssl=1&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://coplay.io/content/images/size/w2000/2024/07/CoPlay-Dashboard-1.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;A children’s hospital wanted an Xbox in every room—but managing dozens of consoles manually was a nightmare.&lt;br&gt;
This project built a &lt;strong&gt;centralized admin system&lt;/strong&gt; to configure, update, and manage all consoles remotely.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~$6,000&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://coplay.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://coplay.io/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
A painfully specific enterprise problem, with a buyer who &lt;em&gt;really&lt;/em&gt; needs a solution.&lt;/p&gt;
&lt;h2 id=&#34;3-one-off-online-fax-yes-fax&#34;&gt;3. One-Off Online Fax (Yes, Fax)
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://www.ifaxapp.com/wp-content/uploads/2023/10/send-and-receive-online-faxes.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.ctfassets.net/r6vlh4dr9f5y/7ML5CSf1sJF2wGS6iFPijX/7cde22c140d74f1802df95e29f9be91a/Screenshot_of_sending_fax_in_Dialpad.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Sometimes you just need to send &lt;strong&gt;one fax&lt;/strong&gt;. Not a subscription. Not an account.&lt;/p&gt;
&lt;p&gt;This service does exactly that: upload → pay → send.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~$500&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://justfaxonline.com/en/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://justfaxonline.com/en/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
It monetizes inconvenience. And faxing is still inconvenient.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;4-duplicate-photo-finder-for-macos&#34;&gt;4. Duplicate Photo Finder for macOS
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/12/475b81c89de6057592ca579d910698a1.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Pasted image 20251224224418&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://eclecticlight.co/wp-content/uploads/2015/11/prefsresedit.png?w=640&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;A macOS app that detects &lt;strong&gt;duplicate and visually similar images&lt;/strong&gt;—handy for photographers with massive local libraries.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Paid users:&lt;/strong&gt; 100+&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://maheepk.net/projects/dedupx/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://maheepk.net/projects/dedupx/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Local storage is exploding. Cleanup tools age &lt;em&gt;very&lt;/em&gt; well.&lt;/p&gt;
&lt;h2 id=&#34;5-gps-based-check-in-for-teams-and-classes&#34;&gt;5. GPS-Based Check-In for Teams and Classes
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://serialio.com/wp-content/uploads/2024/01/GeoFence_Automatic_Check-in_Based_On_Location_iPhone_353x600.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.youhere.org/assets/Options/yh_start.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Teachers, coaches, or team leads set a location and time. Participants must physically be there to check in—verified by GPS.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~€500&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://www.youhere.org/index.php/start/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.youhere.org/index.php/start/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
It replaces paper sign-ins with proof, not trust.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;6-practicing-cold-calls-by-actually-making-calls&#34;&gt;6. Practicing Cold Calls by Actually Making Calls
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/12/9fb7b51dc6146e05585629c78ac83375.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Pasted image 20251224224614&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.prod.website-files.com/64f44392bca35ec50e5d2397/6884f312150f03a43ec3ffdb_Heading%20%2864%29.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Most sales practice tools simulate calls on screen.&lt;/p&gt;
&lt;p&gt;This one &lt;strong&gt;actually dials your phone&lt;/strong&gt; and connects you to an AI, forcing you to practice under real conditions.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~$500&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://coldcallgym.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://coldcallgym.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Fear reduction through exposure—not theory.&lt;/p&gt;
&lt;h2 id=&#34;7-paying-your-kids-to-save-on-taxes&#34;&gt;7. Paying Your Kids to Save on Taxes
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://www.livablesolutions.com/wp-content/uploads/2023/01/Small-Business-File-System-Photo-1-9-2.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Parents log their kids’ work (filing, photos, admin tasks), treat it as a legitimate business expense, and route income into tax-advantaged accounts like a Roth IRA.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MRR:&lt;/strong&gt; ~$500&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://trypixie.com/#how-it-works&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://trypixie.com/#how-it-works&lt;/a&gt;&lt;br&gt;
&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
It turns tax optimization into a family financial strategy.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;8-turn-photos-into-printable-coloring-pages&#34;&gt;8. Turn Photos Into Printable Coloring Pages
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://colorifyai.art/wp-content/uploads/sites/8/2025/06/coloting-page-for-kids.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.etsystatic.com/23190174/r/il/657ec0/4703647124/il_570xN.4703647124_a5yg.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Upload a photo of your pet, child, or vacation—get a clean black-and-white coloring page ready to print.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://dreamandcolor.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://dreamandcolor.com/&lt;/a&gt;&lt;br&gt;
&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Personalization beats stock content every time.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;9-tracking-hard-drive-prices-on-ebay&#34;&gt;9. Tracking Hard Drive Prices on eBay
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://i.ebayimg.com/images/g/TjoAAOSwId1nx6x5/s-l1200.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://monday.com/blog/wp-content/uploads/2022/03/Untitled-233.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;This project scrapes eBay listings for disks and memory cards, parsing titles with &lt;strong&gt;200+ regex rules&lt;/strong&gt;, then monetizes via affiliate links.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MRR:&lt;/strong&gt; $400–$600&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Websites:&lt;/strong&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://unli.xyz/digitalfilmstock/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://unli.xyz/digitalfilmstock/&lt;/a&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://unli.xyz/diskprices/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://unli.xyz/diskprices/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Data cleaning is painful. If you do it once, others will pay.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;10-a-daily-logic-puzzle-no-ads&#34;&gt;10. A Daily Logic Puzzle (No Ads)
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/81TGAvXf-HL._AC_UF894%2C1000_QL80_.jpg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Image&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Each day has a new puzzle: easy on Monday, brutal on Sunday. Revenue comes from &lt;strong&gt;selling puzzle packs&lt;/strong&gt;, not ads.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Website:&lt;/strong&gt; &lt;a class=&#34;link&#34; href=&#34;https://cluesbysam.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://cluesbysam.com/&lt;/a&gt;&lt;br&gt;
&lt;strong&gt;Why it works:&lt;/strong&gt;&lt;br&gt;
Habit + ownership beats ad-driven distraction.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;the-real-pattern-here&#34;&gt;The Real Pattern Here
&lt;/h2&gt;&lt;p&gt;None of these projects are “sexy”.&lt;br&gt;
But they all share something powerful:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A &lt;strong&gt;very specific audience&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;clear, painful problem&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Simple pricing&lt;/li&gt;
&lt;li&gt;No dependence on hype cycles&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In a world obsessed with AI, these projects quietly remind us:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Making money is often about reducing friction, not inventing the future.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If you want to build something sustainable, maybe don’t ask&lt;br&gt;
&lt;em&gt;“What’s the next big thing?”&lt;/em&gt;&lt;br&gt;
Ask instead:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;“What’s an annoying problem people already tolerate?”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Source discussion:&lt;/em&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://news.ycombinator.com/item?id=46307973&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://news.ycombinator.com/item?id=46307973&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Why the Flask Creator Ditched Python for Go in His AI Startup</title>
        <link>https://huizhou92.com/p/why-the-flask-creator-ditched-python-for-go-in-his-ai-startup/</link>
        <pubDate>Fri, 24 Oct 2025 00:00:00 +0000</pubDate>
        
        <guid>https://huizhou92.com/p/why-the-flask-creator-ditched-python-for-go-in-his-ai-startup/</guid>
        <description>&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/40a7d4d3d475ac4b8a9fa89c620bdfff.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;cover-en&#34;
	
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;introduction-a-python-icons-betrayal&#34;&gt;Introduction: A Python Icon&amp;rsquo;s &amp;ldquo;Betrayal&amp;rdquo;
&lt;/h3&gt;&lt;p&gt;Armin Ronacher, creator of Flask—one of Python&amp;rsquo;s most beloved web frameworks—is a household name in the Python community. For years, he&amp;rsquo;s been a standout contributor to Python&amp;rsquo;s ecosystem, with his career deeply intertwined with the language. Yet when launching his AI startup, he made a surprising decision: the company&amp;rsquo;s core backend services wouldn&amp;rsquo;t use Python, the reigning champion of AI, but Go instead.&lt;/p&gt;
&lt;p&gt;This choice raises a fundamental question: Why would a top-tier Python expert &amp;ldquo;betray&amp;rdquo; his preferred language in an AI project where Python should dominate? This isn&amp;rsquo;t just a technical decision—it&amp;rsquo;s the result of an internal struggle between two identities: the &amp;ldquo;Swiss watchmaker&amp;rdquo; who pursues code perfection and the pragmatic founder focused on shipping products. This article explores how Armin Ronacher balances these personas and how AI-era tech companies should rethink their technology stack decisions.&lt;/p&gt;
&lt;h3 id=&#34;1-reconsidering-python-ais-king-with-hidden-concerns&#34;&gt;1. Reconsidering Python: AI&amp;rsquo;s King with Hidden Concerns
&lt;/h3&gt;&lt;p&gt;Python&amp;rsquo;s dominance in today&amp;rsquo;s tech landscape seems unshakeable, especially in AI. However, every technology choice involves tradeoffs, and even Python isn&amp;rsquo;t the best answer in every scenario.&lt;/p&gt;
&lt;h4 id=&#34;pythons-absolute-strengths&#34;&gt;Python&amp;rsquo;s Absolute Strengths
&lt;/h4&gt;&lt;p&gt;First, we must acknowledge that no company can completely avoid Python. Armin Ronacher explicitly states that whether you like it or not, Python will be part of your stack. Its position in these domains is irreplaceable:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Machine Learning (ML)&lt;/strong&gt;: Core for AI inference and data processing tasks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data Processing&lt;/strong&gt;: Unmatched data science ecosystem.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Infrastructure Management&lt;/strong&gt;: For example, Armin uses Pulumi with Python to build his company&amp;rsquo;s infrastructure.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As the &amp;ldquo;glue&amp;rdquo; in the ecosystem and the data science engine, Python&amp;rsquo;s value is undeniable. Even for network-intensive tasks like AI inference, performance bottlenecks typically lie in networking rather than the language itself, making Python an excellent choice.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/2cc384ce04fdb5b0a68c827009ae1601.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Python Ecosystem&#34;
	
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;the-tradeoff-for-core-services&#34;&gt;The Tradeoff for Core Services
&lt;/h4&gt;&lt;p&gt;Despite Python&amp;rsquo;s ubiquity, Armin believes it shouldn&amp;rsquo;t be used to build his new company&amp;rsquo;s &lt;em&gt;primary services&lt;/em&gt;. This consideration isn&amp;rsquo;t rooted in performance bias but stems from deeper insights into language complexity and ecosystem strengths.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Growing Complexity&lt;/strong&gt;: Armin observes that Python itself is becoming increasingly complex. In contrast, Go has maintained relative simplicity since inception. This matters because for an engineering team that needs rapid iteration and collaboration, Go might be &amp;ldquo;an easier language to write.&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Ecosystem Specialization&lt;/strong&gt;: Technology choices aren&amp;rsquo;t just about what a language &lt;em&gt;can&lt;/em&gt; do, but what its ecosystem is &lt;em&gt;good at&lt;/em&gt;. Armin explicitly states he&amp;rsquo;s abandoning Python not for performance reasons, but because of &amp;ldquo;what the ecosystem is good at.&amp;rdquo; While Python is fully capable of handling email parsing (one of Armin&amp;rsquo;s company&amp;rsquo;s core businesses), this isn&amp;rsquo;t where its ecosystem naturally excels. Compared to Go, it&amp;rsquo;s not the &amp;ldquo;chosen one&amp;rdquo; for building this type of scaled core service.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These nuanced considerations led Armin to look toward another language, naturally bringing us to the discussion of Go.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;2-embracing-go-the-pragmatists-victory&#34;&gt;2. Embracing Go: The Pragmatist&amp;rsquo;s Victory
&lt;/h3&gt;&lt;p&gt;If choosing technology is an art, then for startups, the core of this art is pragmatism. Armin Ronacher&amp;rsquo;s choice of Go perfectly embodies this philosophy. Go isn&amp;rsquo;t the most &amp;ldquo;sexy&amp;rdquo; or feature-rich language, but in specific scenarios, it&amp;rsquo;s the most pragmatic, most suitable tool.&lt;/p&gt;
&lt;p&gt;Here are Go&amp;rsquo;s core advantages that made it stand out:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Built for Web Services&lt;/strong&gt;: Go is clearly positioned as &amp;ldquo;an excellent language for building web services&amp;rdquo; with intense focus (&amp;ldquo;really kind of only web services&amp;rdquo;), plus some CLI tool building capability. This focus makes it exceptionally performant in its target domain.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Extreme Pragmatism&lt;/strong&gt;: This is Armin&amp;rsquo;s primary reason for choosing Go. He emphasizes Go&amp;rsquo;s &amp;ldquo;very pragmatic language features,&amp;rdquo; a crucial quality for startups that need to focus on products, ship quickly, and reduce unnecessary technical friction.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Ecosystem Stability&lt;/strong&gt;: For long-term projects, technology longevity is a key consideration. Armin believes Go can be &amp;ldquo;expected to stick around.&amp;rdquo; Even if Google stopped maintaining it someday, the massive community and industry users have enough strength and willingness to sustain its vitality, providing solid guarantees for projects.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Pragmatic Landing Point After Avoiding Python Scaling Concerns and Rust Development Friction&lt;/strong&gt;: After weighing options, Go became an ideal pragmatic choice. It avoids both Python&amp;rsquo;s ecosystem fit issues when building certain types of core services and Rust&amp;rsquo;s steep learning curve and high development &amp;ldquo;friction,&amp;rdquo; making it the best choice for a &amp;ldquo;founder.&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/54a81456afadaf6b501ea505e1ec9d55.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Go Pragmatism&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;To understand this decision more clearly, we need a horizontal comparison of these languages to see their roles in different scenarios.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;3-horizontal-comparison-go-vs-rust-vs-python-use-cases&#34;&gt;3. Horizontal Comparison: Go vs. Rust vs. Python Use Cases
&lt;/h3&gt;&lt;p&gt;Armin Ronacher houses &amp;ldquo;two programmers&amp;rdquo; within himself: one is the &amp;ldquo;Swiss watchmaker&amp;rdquo; pursuing code perfection, usually thriving in the open-source world; the other is the company founder focused on product delivery, making all decisions with pragmatism first. From the latter&amp;rsquo;s perspective, he made a clear distinction between Go, Rust, and Python&amp;rsquo;s applicable scenarios.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/84880d7026e4419aba54ae9c59db2cf7.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Language Comparison&#34;
	
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;python-the-ubiquitous-glue-and-data-science-engine&#34;&gt;Python: The Ubiquitous &amp;ldquo;Glue&amp;rdquo; and Data Science Engine
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Role&lt;/strong&gt;: Python is the universal &amp;ldquo;glue&amp;rdquo; in the ecosystem and the undisputed default choice for data processing and machine learning.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advantages&lt;/strong&gt;: Most powerful library ecosystem, supports rapid prototyping and iteration. In network-intensive tasks like AI inference, the language&amp;rsquo;s performance bottleneck isn&amp;rsquo;t prominent.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tradeoffs&lt;/strong&gt;: The language&amp;rsquo;s inherent complexity is increasing, and for certain types of core services, it may not be the most natural, direct choice.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;rust-the-swiss-watch-for-rust-shaped-problems&#34;&gt;Rust: The &amp;ldquo;Swiss Watch&amp;rdquo; for &amp;ldquo;Rust-Shaped Problems&amp;rdquo;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Role&lt;/strong&gt;: Rust is the expert-level language for solving specific &amp;ldquo;Rust-shaped problems,&amp;rdquo; such as handling binary data, building databases, load balancers, or high-performance Python extension modules.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advantages&lt;/strong&gt;: Memory safety, predictable performance without garbage collection (GC), excellent as Python extensions.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tradeoffs (for Startups)&lt;/strong&gt;: Extremely high development &amp;ldquo;friction.&amp;rdquo; This includes &amp;ldquo;incredibly slow&amp;rdquo; compilation speeds and the steep learning curve of ownership and borrow checking. This makes it highly unsuitable for environments requiring rapid iteration and flexible adjustments.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;go-the-pragmatic-focused-web-service-builder&#34;&gt;Go: The Pragmatic, Focused Web Service Builder
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Role&lt;/strong&gt;: Go is the pragmatic choice for building web services and CLI tools, a focused service-building specialist.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advantages&lt;/strong&gt;: Simple language, easy for teams to learn and master, stable ecosystem, excellent performance in high-concurrency service scenarios.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tradeoffs&lt;/strong&gt;: Its applicable domain is relatively focused, lacking Python&amp;rsquo;s &amp;ldquo;jack-of-all-trades&amp;rdquo; versatility.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notably, Armin also explicitly ruled out using TypeScript/JavaScript for core backend services. Despite its increasingly mature language environment, he&amp;rsquo;s reserved about the &lt;code&gt;npm&lt;/code&gt; ecosystem, stating bluntly: &amp;ldquo;I feel like in the JavaScript ecosystem, I can barely build efficiently without introducing 500+ dependencies, which makes me uncomfortable.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Traditional language selection considerations are now very clear. However, AI&amp;rsquo;s rise introduces a new, potentially disruptive decision dimension.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;4-the-new-deciding-factor-ai-agent-code-generation-quality&#34;&gt;4. The New Deciding Factor: AI Agent Code Generation Quality
&lt;/h3&gt;&lt;p&gt;The rise of AI programming assistants is fundamentally changing software development paradigms, and the underlying logic of technology selection is shifting accordingly. Armin Ronacher, as an entrepreneur heavily relying on AI-assisted coding (which he calls his &amp;ldquo;army of interns&amp;rdquo;), discovered a striking fact: &lt;strong&gt;AI Agent code generation quality has become an unavoidable consideration.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;He reached a clear conclusion from practice:&lt;/p&gt;
&lt;p&gt;&amp;ldquo;I did actual testing&amp;hellip; I found that AI Agents perform much better on Go than on Python.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Why? The reason lies in the language&amp;rsquo;s design philosophy. Armin explains: &amp;ldquo;&lt;strong&gt;Because the abstractions are very thin, it (AI) can understand the code better.&lt;/strong&gt;&amp;rdquo; Go&amp;rsquo;s simplicity and directness make its structure easier for large language models to understand and generate, resulting in more reliable, more correct code.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/dd66f7b1a8e1ae2f60f892111fad65fd.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;AI Code Generation Quality&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;This discovery is significant for a team heavily dependent on AI. When your &amp;ldquo;army of interns&amp;rdquo; is more efficient and makes fewer errors with a particular language, choosing that language isn&amp;rsquo;t just a technical preference—it directly impacts the entire team&amp;rsquo;s productivity.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;conclusion-no-best-language-only-the-right-choice&#34;&gt;Conclusion: No Best Language, Only the Right Choice
&lt;/h3&gt;&lt;p&gt;Armin Ronacher&amp;rsquo;s abandonment of Python for Go isn&amp;rsquo;t a rejection of Python, but rather a highly pragmatic tradeoff made in a new technical paradigm, based on a specific startup context (AI company, rapid iteration, small team collaboration).&lt;/p&gt;
&lt;p&gt;His decision logic can be summarized as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pragmatism Above All&lt;/strong&gt;: For startups, product success matters far more than &amp;ldquo;meticulously crafted&amp;rdquo; code. Choosing tools with less friction and more focus on solving core problems is wise.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Art of Tradeoffs&lt;/strong&gt;: Among language simplicity (easy for teams to master), ecosystem maturity, performance, and development efficiency, Go provides an excellent balance point.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Embracing New Paradigms&lt;/strong&gt;: Incorporating AI code generation quality into core technology selection considerations reflects adaptation to changing times. A language&amp;rsquo;s friendliness to AI is becoming a new, critical productivity metric.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ultimately, Armin&amp;rsquo;s story brings a profound insight to all technical decision-makers: we must continuously reevaluate our toolbox and courageously make the most suitable, most pragmatic choices based on current project needs and emerging technology waves.&lt;/p&gt;
&lt;h3 id=&#34;article-summary&#34;&gt;Article Summary
&lt;/h3&gt;&lt;p&gt;Flask creator Armin Ronacher chose Go over Python for core services in his new AI startup. This decision doesn&amp;rsquo;t negate Python but stems from a startup&amp;rsquo;s extreme pursuit of pragmatism, simplicity, and team efficiency. He views Go as the pragmatic choice after avoiding Rust&amp;rsquo;s development friction and Python&amp;rsquo;s ecosystem specialization limitations. More critically, he discovered that AI Agents generate far better Go code than Python—a decisive new factor in the AI-assisted programming era.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/why-the-flask-creator-ditched-python-for-go-in-his-ai-startup/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Playing Snake in Your Browser&#39;s Address Bar: When the Internet Was Still Fun</title>
        <link>https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/</link>
        <pubDate>Thu, 02 Oct 2025 17:21:30 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/10/c61a3f89ebd38ec64ecc25f6232db78b.png" alt="Featured image of post Playing Snake in Your Browser&#39;s Address Bar: When the Internet Was Still Fun" /&gt;&lt;p&gt;Open Chrome, type &lt;code&gt;https://demian.ferrei.ro/snake#&lt;/code&gt; into the address bar, and you&amp;rsquo;ll suddenly see a string of strange characters.&lt;br&gt;
Yes, you read that right. Keep your eyes on the address bar and control the direction with the arrow keys or WASD.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll see a little snake made of odd-looking symbols (░░░░░░░⠠⠤⠄⡀░░) crawling around inside the address bar, eating food, and growing longer. The entire game plays out inside that thin text field you usually only use to type URLs.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/5ea3b9a9457de17c348e4a8631605888.gif&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Area&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;That&amp;rsquo;s right — this is a fully functional Snake game running entirely inside the browser&amp;rsquo;s URL bar.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Last week, this decade-old project suddenly blew up on Hacker News, racking up 840 upvotes and hundreds of comments. The first reaction from many people was: &lt;em&gt;&amp;ldquo;This is insane. How did you even come up with this?&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;But the story behind this game is even crazier — and it reveals something important about what the modern internet has lost.&lt;/p&gt;
&lt;h2 id=&#34;a-random-curiosity-sparks-a-technical-adventure&#34;&gt;A Random Curiosity Sparks a Technical Adventure
&lt;/h2&gt;&lt;p&gt;The creator, Francisco Uzo, recalls the project&amp;rsquo;s origins: &lt;em&gt;&amp;ldquo;I just wanted to understand how the Braille system worked.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s the essence of hacker culture — &lt;strong&gt;not solving a problem, but chasing pure curiosity.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As he dug into Braille, he noticed something fascinating: each Braille symbol is a 2x4 dot matrix, eight positions in total, each either &amp;ldquo;raised&amp;rdquo; or &amp;ldquo;flat.&amp;rdquo; That gives 2^8 = 256 possible combinations. And Unicode happens to support all 256 Braille characters.&lt;/p&gt;
&lt;p&gt;One night around 3 a.m., it hit him: &lt;strong&gt;&amp;ldquo;Wait, this is basically an 8-bit pixel character set!&amp;rdquo;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;That spark — when two unrelated ideas suddenly connect — is exactly the kind of joy hackers live for.&lt;/p&gt;
&lt;p&gt;And then came the classic hacker instinct: &lt;strong&gt;don&amp;rsquo;t ask whether it&amp;rsquo;s useful — just build it.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The implementation was full of clever hacks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mapping the game world onto Braille character grids, each character acting as a 2x4 pixel block&lt;/li&gt;
&lt;li&gt;Using solid dots (⣿) for the snake&amp;rsquo;s body and blank Braille (⠀) for empty space&lt;/li&gt;
&lt;li&gt;Leveraging JavaScript&amp;rsquo;s &lt;code&gt;history.replaceState()&lt;/code&gt; API to update the URL in real time without polluting the history&lt;/li&gt;
&lt;li&gt;Refreshing the entire frame each tick so the game animates smoothly inside the address bar&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Francisco&amp;rsquo;s openness was just as &amp;ldquo;hacker-ish&amp;rdquo;: &lt;em&gt;&amp;ldquo;The source code isn&amp;rsquo;t minified or obfuscated. Just hit Ctrl+U and you&amp;rsquo;ll see everything.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The whole thing was only a few hundred lines of JavaScript — concise, readable, and elegant. &lt;strong&gt;In the hacker mindset, code isn&amp;rsquo;t just for execution — it should also be legible, learnable, and inspiring.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;wait-why-does-my-game-look-broken&#34;&gt;Wait… Why Does My Game Look Broken?
&lt;/h2&gt;&lt;p&gt;If you try the game today, you might just see a mess of &lt;code&gt;%20&lt;/code&gt;, backslashes, and gibberish. The snake barely moves — or sometimes the game doesn&amp;rsquo;t run at all.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;It&amp;rsquo;s not your fault. It&amp;rsquo;s not even the code&amp;rsquo;s fault. The browser has changed.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Francisco admitted, &lt;em&gt;&amp;ldquo;This project was written for browsers ten years ago. Since then, browsers have made certain &amp;lsquo;security improvements&amp;rsquo; that severely limit what&amp;rsquo;s possible in the URL bar.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The most critical change? &lt;strong&gt;Modern browsers now forcefully escape all spaces in URLs.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In the game&amp;rsquo;s design, the blank Braille character (⠀) represented empty space. However, browsers now escape those characters as &lt;code&gt;%20&lt;/code&gt; or something else, which ruins the visual output.&lt;/p&gt;
&lt;p&gt;Francisco even built a fallback system that measured text widths via Canvas and replaced escaped characters on the fly — but it only worked partially.&lt;/p&gt;
&lt;p&gt;He appealed to browser bug trackers. Developers sympathized but ultimately concluded: &lt;strong&gt;&amp;ldquo;As always, security outweighs fun.&amp;rdquo;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As a result, users&amp;rsquo; experiences varied wildly:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some people on Chrome scored over 2,000 points.&lt;/li&gt;
&lt;li&gt;Others saw a screen full of garbage in Firefox.&lt;/li&gt;
&lt;li&gt;On iOS Safari, the game sometimes didn&amp;rsquo;t even render&lt;/li&gt;
&lt;li&gt;Some users found their browsing history polluted with every single game frame.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The same code, drastically different behavior across browsers. That&amp;rsquo;s just the reality of modern web development.&lt;/p&gt;
&lt;h2 id=&#34;the-golden-age-of-weird-browser-games&#34;&gt;The Golden Age of &amp;ldquo;Weird Browser Games&amp;rdquo;
&lt;/h2&gt;&lt;p&gt;Snake in the address bar wasn&amp;rsquo;t the only project of its kind. The Hacker News discussion turned into a nostalgia trip, with people recalling a whole wave of unconventional browser experiments.&lt;/p&gt;
&lt;h3 id=&#34;2048-in-the-url&#34;&gt;&lt;strong&gt;2048 In the URL&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Someone linked to &lt;a class=&#34;link&#34; href=&#34;https://aquova.net/games/2048/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://aquova.net/games/2048/&lt;/a&gt; — a port of the once-famous puzzle game, implemented entirely inside the address bar using the same Braille and URL-refresh trick.&lt;/p&gt;
&lt;h3 id=&#34;snake-in-the-browser-tab-title&#34;&gt;&lt;strong&gt;Snake In the Browser Tab Title&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Francisco mentioned that someone on Reddit made a version that runs inside the tab&amp;rsquo;s title instead. It was basically a compromise — no longer in the address bar, but safe from URL escaping.&lt;/p&gt;
&lt;h3 id=&#34;tinyjs-snake&#34;&gt;&lt;strong&gt;TinyJS Snake&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;In 2023, another developer built &lt;a class=&#34;link&#34; href=&#34;https://danielgjackson.github.io/tinyjs#snake&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;a similar Snake clone&lt;/a&gt; using a different technique. At the time, browser restrictions weren&amp;rsquo;t as strict.&lt;/p&gt;
&lt;h3 id=&#34;3d-worlds-in-the-url&#34;&gt;&lt;strong&gt;3D Worlds in the URL&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Another project took things further: &lt;a class=&#34;link&#34; href=&#34;https://matthew.rayfield.world/articles/games-and-graphics-in-popup-url-bars/#:~:text=The%203D%20Room&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;an interactive 3D environment rendered through unconventional browser features&lt;/a&gt;.&lt;br&gt;
One commenter joked: &lt;em&gt;&amp;ldquo;It&amp;rsquo;s not Doom, but you can walk around in 3D.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;What do all these have in common? &lt;strong&gt;They were built for fun, out of curiosity, with no concern for practicality.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;No commercial value. No business use case. Not even &amp;ldquo;best practices.&amp;rdquo;&lt;br&gt;
But they embodied the spirit of the early web: &lt;strong&gt;a playground where people could experiment, push boundaries, and have fun.&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;why-are-projects-like-this-so-hard-now&#34;&gt;Why Are Projects Like This So Hard Now?
&lt;/h2&gt;&lt;p&gt;It&amp;rsquo;s not just the space escaping problem. Over the past decade, browsers have introduced countless so-called &lt;strong&gt;security improvements&lt;/strong&gt;:&lt;/p&gt;
&lt;h3 id=&#34;history-api-limits&#34;&gt;&lt;strong&gt;History API Limits&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Francisco originally used &lt;code&gt;history.replaceState()&lt;/code&gt; to update the URL without spamming history entries. Modern browsers now throttle calls to this API, forcing fallback to &lt;code&gt;location.hash&lt;/code&gt; — which clutters your browsing history with every frame of gameplay.&lt;/p&gt;
&lt;h3 id=&#34;url-length-restrictions&#34;&gt;&lt;strong&gt;URL Length Restrictions&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Different browsers cap URL length anywhere from 2,000 to tens of thousands of characters. Encoding game state into URLs quickly hits those ceilings.&lt;/p&gt;
&lt;h3 id=&#34;character-set-restrictions&#34;&gt;&lt;strong&gt;Character Set Restrictions&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;More and more Unicode characters are marked as &amp;ldquo;unsafe&amp;rdquo; for URLs. Browsers escape or block them, killing Unicode art projects outright.&lt;/p&gt;
&lt;h3 id=&#34;mobile-compatibility&#34;&gt;&lt;strong&gt;Mobile Compatibility&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Many mobile browsers hide the URL bar entirely while scrolling — making address-bar games literally unplayable.&lt;/p&gt;
&lt;p&gt;Francisco summed it up: &lt;em&gt;&amp;ldquo;Every browser change since then has made projects like this harder. I got some sympathy in bug trackers, but security always wins.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;when-security-kills-the-fun&#34;&gt;When Security Kills the Fun
&lt;/h2&gt;&lt;p&gt;Here&amp;rsquo;s the fundamental tension:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nobody disputes the importance of browser security.&lt;/strong&gt;&lt;br&gt;
URL injection attacks, XSS vulnerabilities, phishing — these are real threats affecting billions of users. Browser developers have a duty to protect people.&lt;/p&gt;
&lt;p&gt;But every &amp;ldquo;security improvement&amp;rdquo; quietly closes off a door to creativity.&lt;/p&gt;
&lt;p&gt;Francisco&amp;rsquo;s code worked flawlessly a decade ago. Today, it&amp;rsquo;s broken not because it was bad, but because the browser &amp;ldquo;evolved.&amp;rdquo; That evolution made the web safer — but also more controlled, more uniform, and frankly… more boring.&lt;/p&gt;
&lt;h3 id=&#34;it&#34;&gt;&lt;strong&gt;It&amp;rsquo;s Not Just About Games&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;One Hacker News commenter sneered: &lt;em&gt;&amp;ldquo;Why don&amp;rsquo;t people build something useful instead of abusing the internet?&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The community overwhelmingly pushed back:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&amp;ldquo;The learning value from projects like this is massive.&amp;rdquo;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&amp;ldquo;Creative play matters for skill development too.&amp;rdquo;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&amp;ldquo;This is exactly why I come to HN — 100% hacker spirit.&amp;rdquo;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&amp;ldquo;ChatGPT couldn&amp;rsquo;t have come up with this. I love the creativity.&amp;rdquo;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The best response was simple:&lt;br&gt;
&lt;em&gt;&amp;ldquo;To most people, this is nothing. To me, it&amp;rsquo;s insane. How did you even think of this?&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;That&amp;rsquo;s the point.&lt;/strong&gt; The value of projects like this isn&amp;rsquo;t in utility, but in pure human creativity — driven by curiosity, joy, and the urge to ask &lt;em&gt;&amp;ldquo;why not?&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;And every time we &amp;ldquo;tighten security,&amp;rdquo; we don&amp;rsquo;t just close loopholes. We also close off avenues for wonder.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;trade-offs-are-necessary-but-we-should-acknowledge-the-cost&#34;&gt;&lt;strong&gt;Trade-offs Are Necessary, But We Should Acknowledge the Cost&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;This isn&amp;rsquo;t about blaming browser developers. They face incredibly difficult trade-offs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allow flexible URL encoding vs. prevent injection attacks&lt;/li&gt;
&lt;li&gt;Support high-frequency API calls vs. avoid performance issues&lt;/li&gt;
&lt;li&gt;Display arbitrary Unicode characters vs. prevent phishing scams&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;There&amp;rsquo;s no perfect answer.&lt;/strong&gt; Every decision has its cost.&lt;/p&gt;
&lt;p&gt;But we should at least be aware of and discuss these costs. When we say &amp;ldquo;security first,&amp;rdquo; we should ask: &amp;ldquo;What are we losing because of this?&amp;rdquo; When we say &amp;ldquo;user experience optimization,&amp;rdquo; we should ask: &amp;ldquo;Whose experience are we optimizing for?&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Francisco&amp;rsquo;s response from browser bug trackers was typical: &amp;ldquo;I understand your frustration, but security must come first.&amp;rdquo; This answer is technically unassailable, but it also represents a broader trend: &lt;strong&gt;on the modern internet, control and security are systematically overwhelming creativity and fun.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;in-the-age-of-ai-human-creativity-matters-more&#34;&gt;In the Age of AI, Human Creativity Matters More
&lt;/h2&gt;&lt;p&gt;When asked about AI, Francisco said something striking:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&amp;ldquo;This game has been online for ten years. It&amp;rsquo;s probably in AI training data. A robot might be able to replicate it, but it could never enjoy it. (At least not yet.)&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;That gets to the heart of our cultural anxiety today. In an era where ChatGPT can generate code in seconds and Copilot can autocomplete whole functions — what projects are still worth building by hand?&lt;/p&gt;
&lt;p&gt;The answer might just lie in this Snake game.&lt;/p&gt;
&lt;p&gt;AI can parse Braille characters, understand Unicode, and spit out JavaScript. But AI can&amp;rsquo;t feel:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The 3 a.m. epiphany that &amp;ldquo;Braille could be pixels&amp;rdquo;&lt;/li&gt;
&lt;li&gt;the giddy surprise of watching a snake slither inside a URL bar for the first time&lt;/li&gt;
&lt;li&gt;The stubborn joy of debugging escape sequences for hours&lt;/li&gt;
&lt;li&gt;The quiet pride of seeing strangers enjoy your work a decade later&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are &lt;strong&gt;uniquely human creative experiences.&lt;/strong&gt;&lt;br&gt;
In a world where AI can replicate almost all code, that human spark is more precious than ever.&lt;/p&gt;
&lt;p&gt;Francisco&amp;rsquo;s project wasn&amp;rsquo;t created to solve a problem — it was created for exploration and fun. That motivation, that process, that pure creative joy — &lt;strong&gt;that&amp;rsquo;s something AI can never truly possess.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;we-need-more-projects-like-this&#34;&gt;We Need More Projects Like This
&lt;/h2&gt;&lt;p&gt;Snake in the URL bar went viral, not because it&amp;rsquo;s useful or profitable, but because it reminded us of something essential:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The internet shouldn&amp;rsquo;t just be efficient, safe, and standardized. It should also be surprising, playful, and experimental.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When Francisco asked himself, &amp;ldquo;How does Braille work?&amp;rdquo; ten years ago, he wasn&amp;rsquo;t solving a business problem or optimizing UX. He was just curious. That curiosity created something that made thousands of strangers smile.&lt;/p&gt;
&lt;p&gt;In today&amp;rsquo;s increasingly homogeneous, &amp;ldquo;safe,&amp;rdquo; and algorithmically optimized internet, we need more of this. Not because it&amp;rsquo;s useful, but because it reminds us:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Technology isn&amp;rsquo;t only about efficiency and safety — it should also be about wonder and joy.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, how many points can &lt;em&gt;you&lt;/em&gt; score? Does your browser even support it?&lt;/p&gt;
&lt;p&gt;Or maybe the real question is: &lt;strong&gt;what&amp;rsquo;s the last &amp;ldquo;useless but fun&amp;rdquo; project you built?&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Playing Snake in Your Browser’s Address Bar: When the Internet Was Still Fun</title>
        <link>https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/</link>
        <pubDate>Thu, 02 Oct 2025 17:21:30 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/10/c61a3f89ebd38ec64ecc25f6232db78b.png" alt="Featured image of post Playing Snake in Your Browser’s Address Bar: When the Internet Was Still Fun" /&gt;&lt;p&gt;Open Chrome, type &lt;code&gt;https://demian.ferrei.ro/snake#&lt;/code&gt; into the address bar, and you’ll suddenly see a string of strange characters.&lt;br&gt;
Yes, you read that right. Keep your eyes on the address bar and control the direction with the arrow keys or WASD.&lt;/p&gt;
&lt;p&gt;You’ll see a little snake made of odd-looking symbols (░░░░░░░⠠⠤⠄⡀░░) crawling around inside the address bar, eating food, and growing longer. The entire game plays out inside that thin text field you usually only use to type URLs.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/10/5ea3b9a9457de17c348e4a8631605888.gif&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Area&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;That’s right — this is a fully functional Snake game running entirely inside the browser’s URL bar.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Last week, this decade-old project suddenly blew up on Hacker News, racking up 840 upvotes and hundreds of comments. The first reaction from many people was: &lt;em&gt;“This is insane. How did you even come up with this?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;But the story behind this game is even crazier — and it reveals something important about what the modern internet has lost.&lt;/p&gt;
&lt;h2 id=&#34;a-random-curiosity-sparks-a-technical-adventure&#34;&gt;A Random Curiosity Sparks a Technical Adventure
&lt;/h2&gt;&lt;p&gt;The creator, Francisco Uzo, recalls the project’s origins: &lt;em&gt;“I just wanted to understand how the Braille system worked.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;That’s the essence of hacker culture — &lt;strong&gt;not solving a problem, but chasing pure curiosity.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As he dug into Braille, he noticed something fascinating: each Braille symbol is a 2x4 dot matrix, eight positions in total, each either “raised” or “flat.” That gives 2^8 = 256 possible combinations. And Unicode happens to support all 256 Braille characters.&lt;/p&gt;
&lt;p&gt;One night around 3 a.m., it hit him: &lt;strong&gt;“Wait, this is basically an 8-bit pixel character set!”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;That spark — when two unrelated ideas suddenly connect — is exactly the kind of joy hackers live for.&lt;/p&gt;
&lt;p&gt;And then came the classic hacker instinct: &lt;strong&gt;don’t ask whether it’s useful — just build it.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The implementation was full of clever hacks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mapping the game world onto Braille character grids, each character acting as a 2x4 pixel block&lt;/li&gt;
&lt;li&gt;Using solid dots (⣿) for the snake’s body and blank Braille (⠀) for empty space&lt;/li&gt;
&lt;li&gt;Leveraging JavaScript’s &lt;code&gt;history.replaceState()&lt;/code&gt; API to update the URL in real time without polluting the history&lt;/li&gt;
&lt;li&gt;Refreshing the entire frame each tick so the game animates smoothly inside the address bar&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Francisco’s openness was just as “hacker-ish”: &lt;em&gt;“The source code isn’t minified or obfuscated. Just hit Ctrl+U and you’ll see everything.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The whole thing was only a few hundred lines of JavaScript — concise, readable, and elegant. &lt;strong&gt;In the hacker mindset, code isn’t just for execution — it should also be legible, learnable, and inspiring.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;wait-why-does-my-game-look-broken&#34;&gt;Wait… Why Does My Game Look Broken?
&lt;/h2&gt;&lt;p&gt;If you try the game today, you might just see a mess of &lt;code&gt;%20&lt;/code&gt;, backslashes, and gibberish. The snake barely moves — or sometimes the game doesn’t run at all.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;It’s not your fault. It’s not even the code’s fault. The browser has changed.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Francisco admitted, &lt;em&gt;“This project was written for browsers ten years ago. Since then, browsers have made certain ‘security improvements’ that severely limit what’s possible in the URL bar.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The most critical change? &lt;strong&gt;Modern browsers now forcefully escape all spaces in URLs.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In the game’s design, the blank Braille character (⠀) represented empty space. However, browsers now escape those characters as &lt;code&gt;%20&lt;/code&gt; or something else, which ruins the visual output.&lt;/p&gt;
&lt;p&gt;Francisco even built a fallback system that measured text widths via Canvas and replaced escaped characters on the fly — but it only worked partially.&lt;/p&gt;
&lt;p&gt;He appealed to browser bug trackers. Developers sympathized but ultimately concluded: &lt;strong&gt;“As always, security outweighs fun.”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As a result, users’ experiences varied wildly:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some people on Chrome scored over 2,000 points.&lt;/li&gt;
&lt;li&gt;Others saw a screen full of garbage in Firefox.&lt;/li&gt;
&lt;li&gt;On iOS Safari, the game sometimes didn’t even render&lt;/li&gt;
&lt;li&gt;Some users found their browsing history polluted with every single game frame.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The same code, drastically different behavior across browsers. That’s just the reality of modern web development.&lt;/p&gt;
&lt;h2 id=&#34;the-golden-age-of-weird-browser-games&#34;&gt;The Golden Age of “Weird Browser Games”
&lt;/h2&gt;&lt;p&gt;Snake in the address bar wasn’t the only project of its kind. The Hacker News discussion turned into a nostalgia trip, with people recalling a whole wave of unconventional browser experiments.&lt;/p&gt;
&lt;h3 id=&#34;2048-in-the-url&#34;&gt;&lt;strong&gt;2048 In the URL&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Someone linked to &lt;a class=&#34;link&#34; href=&#34;https://aquova.net/games/2048/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://aquova.net/games/2048/&lt;/a&gt; — a port of the once-famous puzzle game, implemented entirely inside the address bar using the same Braille and URL-refresh trick.&lt;/p&gt;
&lt;h3 id=&#34;snake-in-the-browser-tab-title&#34;&gt;&lt;strong&gt;Snake In the Browser Tab Title&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Francisco mentioned that someone on Reddit made a version that runs inside the tab’s title instead. It was basically a compromise — no longer in the address bar, but safe from URL escaping.&lt;/p&gt;
&lt;h3 id=&#34;tinyjs-snake&#34;&gt;&lt;strong&gt;TinyJS Snake&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;In 2023, another developer built &lt;a class=&#34;link&#34; href=&#34;https://danielgjackson.github.io/tinyjs#snake&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;a similar Snake clone&lt;/a&gt; using a different technique. At the time, browser restrictions weren’t as strict.&lt;/p&gt;
&lt;h3 id=&#34;3d-worlds-in-the-url&#34;&gt;&lt;strong&gt;3D Worlds in the URL&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Another project took things further: &lt;a class=&#34;link&#34; href=&#34;https://matthew.rayfield.world/articles/games-and-graphics-in-popup-url-bars/#:~:text=The%203D%20Room&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;an interactive 3D environment rendered through unconventional browser features&lt;/a&gt;.&lt;br&gt;
One commenter joked: &lt;em&gt;“It’s not Doom, but you can walk around in 3D.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;What do all these have in common? &lt;strong&gt;They were built for fun, out of curiosity, with no concern for practicality.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;No commercial value. No business use case. Not even “best practices.”&lt;br&gt;
But they embodied the spirit of the early web: &lt;strong&gt;a playground where people could experiment, push boundaries, and have fun.&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;why-are-projects-like-this-so-hard-now&#34;&gt;Why Are Projects Like This So Hard Now?
&lt;/h2&gt;&lt;p&gt;It’s not just the space escaping problem. Over the past decade, browsers have introduced countless so-called &lt;strong&gt;security improvements&lt;/strong&gt;:&lt;/p&gt;
&lt;h3 id=&#34;history-api-limits&#34;&gt;&lt;strong&gt;History API Limits&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Francisco originally used &lt;code&gt;history.replaceState()&lt;/code&gt; to update the URL without spamming history entries. Modern browsers now throttle calls to this API, forcing fallback to &lt;code&gt;location.hash&lt;/code&gt; — which clutters your browsing history with every frame of gameplay.&lt;/p&gt;
&lt;h3 id=&#34;url-length-restrictions&#34;&gt;&lt;strong&gt;URL Length Restrictions&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Different browsers cap URL length anywhere from 2,000 to tens of thousands of characters. Encoding game state into URLs quickly hits those ceilings.&lt;/p&gt;
&lt;h3 id=&#34;character-set-restrictions&#34;&gt;&lt;strong&gt;Character Set Restrictions&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;More and more Unicode characters are marked as “unsafe” for URLs. Browsers escape or block them, killing Unicode art projects outright.&lt;/p&gt;
&lt;h3 id=&#34;mobile-compatibility&#34;&gt;&lt;strong&gt;Mobile Compatibility&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Many mobile browsers hide the URL bar entirely while scrolling — making address-bar games literally unplayable.&lt;/p&gt;
&lt;p&gt;Francisco summed it up: &lt;em&gt;“Every browser change since then has made projects like this harder. I got some sympathy in bug trackers, but security always wins.”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;when-security-kills-the-fun&#34;&gt;When Security Kills the Fun
&lt;/h2&gt;&lt;p&gt;Here’s the fundamental tension:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nobody disputes the importance of browser security.&lt;/strong&gt;&lt;br&gt;
URL injection attacks, XSS vulnerabilities, phishing — these are real threats affecting billions of users. Browser developers have a duty to protect people.&lt;/p&gt;
&lt;p&gt;But every “security improvement” quietly closes off a door to creativity.&lt;/p&gt;
&lt;p&gt;Francisco’s code worked flawlessly a decade ago. Today, it’s broken not because it was bad, but because the browser “evolved.” That evolution made the web safer — but also more controlled, more uniform, and frankly… more boring.&lt;/p&gt;
&lt;h3 id=&#34;its-not-just-about-games&#34;&gt;&lt;strong&gt;It’s Not Just About Games&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;One Hacker News commenter sneered: &lt;em&gt;“Why don’t people build something useful instead of abusing the internet?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The community overwhelmingly pushed back:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;“The learning value from projects like this is massive.”&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;“Creative play matters for skill development too.”&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;“This is exactly why I come to HN — 100% hacker spirit.”&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;“ChatGPT couldn’t have come up with this. I love the creativity.”&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The best response was simple:&lt;br&gt;
&lt;em&gt;“To most people, this is nothing. To me, it’s insane. How did you even think of this?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;That’s the point.&lt;/strong&gt; The value of projects like this isn’t in utility, but in pure human creativity — driven by curiosity, joy, and the urge to ask &lt;em&gt;“why not?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;And every time we “tighten security,” we don’t just close loopholes. We also close off avenues for wonder.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;in-the-age-of-ai-human-creativity-matters-more&#34;&gt;In the Age of AI, Human Creativity Matters More
&lt;/h2&gt;&lt;p&gt;When asked about AI, Francisco said something striking:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;“This game has been online for ten years. It’s probably in AI training data. A robot might be able to replicate it, but it could never enjoy it. (At least not yet.)”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;That gets to the heart of our cultural anxiety today. In an era where ChatGPT can generate code in seconds and Copilot can autocomplete whole functions — what projects are still worth building by hand?&lt;/p&gt;
&lt;p&gt;The answer might just lie in this Snake game.&lt;/p&gt;
&lt;p&gt;AI can parse Braille characters, understand Unicode, and spit out JavaScript. But AI can’t feel:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The 3 a.m. epiphany that “Braille could be pixels”&lt;/li&gt;
&lt;li&gt;the giddy surprise of watching a snake slither inside a URL bar for the first time&lt;/li&gt;
&lt;li&gt;The stubborn joy of debugging escape sequences for hours&lt;/li&gt;
&lt;li&gt;The quiet pride of seeing strangers enjoy your work a decade later&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are &lt;strong&gt;uniquely human creative experiences.&lt;/strong&gt;&lt;br&gt;
In a world where AI can replicate almost all code, that human spark is more precious than ever.&lt;/p&gt;
&lt;h2 id=&#34;we-need-more-projects-like-this&#34;&gt;We Need More Projects Like This
&lt;/h2&gt;&lt;p&gt;Snake in the URL bar went viral, not because it’s useful or profitable, but because it reminded us of something essential:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The internet shouldn’t just be efficient, safe, and standardized. It should also be surprising, playful, and experimental.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When Francisco asked himself, “How does Braille work?” ten years ago, he wasn’t solving a business problem or optimizing UX. He was just curious. That curiosity created something that made thousands of strangers smile.&lt;/p&gt;
&lt;p&gt;In today’s increasingly homogeneous, “safe,” and algorithmically optimized internet, we need more of this. Not because it’s useful, but because it reminds us:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Technology isn’t only about efficiency and safety — it should also be about wonder and joy.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, how many points can &lt;em&gt;you&lt;/em&gt; score? Does your browser even support it?&lt;/p&gt;
&lt;p&gt;Or maybe the real question is: &lt;strong&gt;what’s the last “useless but fun” project you built?&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/playing-snake-in-your-browsers-address-bar-when-the-internet-was-still-fun/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Official discussions readdress error handling: Why has the new syntax been delayed?</title>
        <link>https://huizhou92.com/p/official-discussions-readdress-error-handling-why-has-the-new-syntax-been-delayed/</link>
        <pubDate>Wed, 04 Jun 2025 20:34:41 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/official-discussions-readdress-error-handling-why-has-the-new-syntax-been-delayed/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/06/19d137fd979f2645bc026a4c08113aed.png" alt="Featured image of post Official discussions readdress error handling: Why has the new syntax been delayed?" /&gt;&lt;h1 id=&#34;go-officials-revisit-error-handling--why-the-new-syntax-is-still-stuck&#34;&gt;Go Officials Revisit Error Handling — Why the New Syntax Is Still Stuck
&lt;/h1&gt;&lt;p&gt;Recently, the official Go blog published a post titled &lt;a class=&#34;link&#34; href=&#34;https://go.dev/blog/error-syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;em&gt;On | No syntactic support for error handling&lt;/em&gt;&lt;/a&gt;. Contrary to the community’s anticipation for a breakthrough in syntax, the article took a step back—revisiting Go’s long and rocky history of failed attempts to simplify error handling.&lt;/p&gt;
&lt;p&gt;So, why did the Go team choose to publish this now?&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;why-does-the-go-team-keep-revisiting-error-handling&#34;&gt;Why Does the Go Team Keep Revisiting Error Handling?
&lt;/h2&gt;&lt;p&gt;Since its inception, Go has been celebrated for its simplicity and clarity. But one area has always stood out as a sore spot: &lt;strong&gt;error handling is verbose and repetitive.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the familiar Go pattern we’ve all seen:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;printSum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strconv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Atoi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strconv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Atoi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;result:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The repeated &lt;code&gt;if err != nil&lt;/code&gt; blocks often feel &lt;strong&gt;mechanical and boilerplate&lt;/strong&gt;. Over the years, the Go team has made multiple attempts to design a cleaner syntax—but each one has failed to gain enough traction for implementation.&lt;/p&gt;
&lt;h2 id=&#34;failed-attempts-that-once-held-promise&#34;&gt;Failed Attempts That Once Held Promise
&lt;/h2&gt;&lt;p&gt;Here are a few notable proposals that stirred hope but never made it into the language:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;2018: &lt;a class=&#34;link&#34; href=&#34;https://go.googlesource.com/proposal/&amp;#43;/master/design/go2draft-error-handling.md&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;check&lt;/code&gt; and &lt;code&gt;handle&lt;/code&gt;&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
Introduced new keywords to reduce error handling verbosity, but were eventually rejected due to concerns about added complexity.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;2019: &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/32437&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;try&lt;/code&gt;&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
Proposed a built-in &lt;code&gt;try()&lt;/code&gt; function to handle errors more concisely. The community pushed back, citing it as “too implicit” and against Go’s design philosophy.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;2024: The &lt;code&gt;?&lt;/code&gt; Operator Inspired by Rust&lt;/strong&gt;&lt;br&gt;
Ian Lance Taylor suggested borrowing Rust’s &lt;code&gt;?&lt;/code&gt; operator to reduce boilerplate (&lt;a class=&#34;link&#34; href=&#34;https://go.dev/issue/71203&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;proposal #71203&lt;/a&gt;). Once again, the community responded with strong opposition.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I also wrote a blog post about it.&lt;/p&gt;
&lt;p&gt;Each failed proposal reveals more than just technical challenges. They reflect a deep-rooted cultural norm in the Go community:&lt;br&gt;
&lt;strong&gt;“Clarity is better than cleverness.”&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;whats-the-real-message-behind-this-blog-post&#34;&gt;What’s The Real Message Behind This Blog Post?
&lt;/h2&gt;&lt;p&gt;If you read between the lines, you’ll see this blog isn’t just a retrospective—it’s a &lt;strong&gt;strategic response&lt;/strong&gt; to the growing noise in the community:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;“Do we need new syntax for error handling?”&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The post sends a subtle but critical signal:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;The question isn’t just about syntax. It’s about the philosophy of the language itself.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Go’s team isn’t aiming to push a new solution just yet. Instead, they want to steer the community back to first principles—asking:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;What kind of language do we truly want Go to be?&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;explicit-is-better-than-implicit--a-principle-go-wont-let-go&#34;&gt;“Explicit Is Better Than Implicit” — A Principle Go Won’t Let Go
&lt;/h2&gt;&lt;p&gt;Go&amp;rsquo;s strength lies in its &lt;strong&gt;unambiguous, explicit&lt;/strong&gt; nature. Every new syntax proposal must pass a rigorous checklist:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Does it preserve clarity?&lt;/li&gt;
&lt;li&gt;Does the benefit justify the added complexity?&lt;/li&gt;
&lt;li&gt;What unintended side effects might it introduce?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These principles make every proposal an uphill battle—and explain why so many attempts have been shut down before reaching their intended conclusion.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;so-where-does-this-leave-us&#34;&gt;So, Where Does This Leave Us?
&lt;/h2&gt;&lt;p&gt;Another key takeaway from the blog post is this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;The Go team has come to terms with the reality that a new error-handling syntax isn’t coming anytime soon.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That doesn’t mean it’s impossible—just that the right solution hasn’t been found. The Go team is signaling: the door remains open, but more experimentation, real-world feedback, and reflection are needed.&lt;/p&gt;
&lt;p&gt;In the meantime, Go developers will need to live with the existing pattern. But that also means Go will continue to be what it’s always been: &lt;strong&gt;explicit, transparent, and devoid of magic.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;This blog post might look like a historical reflection, even an admission of past failures—but it’s really a catalyst. A challenge to the community:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;What do we truly want Go to become?&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;How much clarity are we willing to trade for convenience?&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You may disagree with the current state of affairs. But it’s hard to deny that this kind of introspection is essential for the health of any programming language.&lt;/p&gt;
&lt;p&gt;Yes, the following proposal might fail again.&lt;br&gt;
Or the community may one day strike the perfect balance.&lt;/p&gt;
&lt;p&gt;What’s certain is this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;The Go community is still thinking, still debating—and still evolving.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://go.dev/blog/error-syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Original blog post →&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/official-discussions-readdress-error-handling-why-has-the-new-syntax-been-delayed/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Go Action Managing Go Application Lifecycles in Kubernetes</title>
        <link>https://huizhou92.com/p/go-action-managing-go-application-lifecycles-in-kubernetes/</link>
        <pubDate>Mon, 02 Jun 2025 17:45:34 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/go-action-managing-go-application-lifecycles-in-kubernetes/</guid>
        <description>&lt;p&gt;This article explores best practices for developing Go applications in Kubernetes, focusing on the different stages of a Pod’s lifecycle and the role of Kubernetes termination signals. Properly managing these phases ensures smooth application shutdowns, preventing data loss or disruptions to user experience. By mastering lifecycle management, teams can efficiently handle updates and workload adjustments.&lt;/p&gt;
&lt;!-- more--&gt;
&lt;h2 id=&#34;the-three-phases-of-an-applications-lifecycle&#34;&gt;The Three Phases of an Application’s Lifecycle
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Application Startup&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Application Runtime&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Application Shutdown&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Each phase requires careful attention to ensure everything proceeds as expected. While most teams focus solely on runtime, managing all three phases in Kubernetes is equally critical.&lt;/p&gt;
&lt;h3 id=&#34;1-application-startup&#34;&gt;1. Application Startup
&lt;/h3&gt;&lt;p&gt;In Kubernetes, a Pod is considered ready when all its containers are prepared to accept requests. This readiness is determined using &lt;strong&gt;readiness probes&lt;/strong&gt; and &lt;strong&gt;readiness gates&lt;/strong&gt;.&lt;/p&gt;
&lt;h4 id=&#34;the-role-of-readiness-probes&#34;&gt;The Role of Readiness Probes
&lt;/h4&gt;&lt;p&gt;A readiness probe signals whether a service is ready to handle traffic. It periodically checks the application’s state to confirm availability. Here’s an example of a readiness probe definition:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;readinessProbe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;httpGet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/ready&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;timeoutSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;periodSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Key Parameters:&lt;/strong&gt;&lt;br&gt;
• &lt;code&gt;timeoutSeconds&lt;/code&gt;: Maximum time allowed for the probe to respond.&lt;br&gt;
• &lt;code&gt;periodSeconds&lt;/code&gt;: Frequency at which the probe is executed.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;2-application-runtime&#34;&gt;2. Application Runtime
&lt;/h3&gt;&lt;p&gt;During runtime, &lt;strong&gt;liveness&lt;/strong&gt; and &lt;strong&gt;readiness probes&lt;/strong&gt; monitor the service’s health. The liveness probe, in particular, detects deadlocks and determines whether a container should be restarted.&lt;/p&gt;
&lt;h4 id=&#34;example-liveness-probe&#34;&gt;Example Liveness Probe
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;livenessProbe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;httpGet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/health&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;timeoutSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;periodSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;initialDelaySeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Important Considerations:&lt;/strong&gt;&lt;br&gt;
• Ensure probes respond quickly to avoid unnecessary restarts due to temporary load spikes.&lt;br&gt;
• Avoid coupling probes with external service dependencies—a single failure shouldn’t trigger cascading restarts.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;3-application-shutdown&#34;&gt;3. Application Shutdown
&lt;/h3&gt;&lt;p&gt;The shutdown phase involves gracefully terminating a Pod. Kubernetes manages this by sending &lt;code&gt;SIGTERM&lt;/code&gt; followed by &lt;code&gt;SIGKILL&lt;/code&gt; if necessary.&lt;/p&gt;
&lt;h4 id=&#34;graceful-shutdown-in-go&#34;&gt;Graceful Shutdown in Go
&lt;/h4&gt;&lt;p&gt;Here’s an example of handling graceful shutdowns in a Go application:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Step 1: Startup&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;startService&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NotifyContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGINT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGTERM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;zerolog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;New&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;With&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;service&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ServiceName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Unable to setup config&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;mux&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewServeMux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;mux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;HandleFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/health&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;healthHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;mux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;HandleFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/ready&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;readyHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;mux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;HandleFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/task&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;taskHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;Addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;         &lt;span class=&#34;s&#34;&gt;&amp;#34;:&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ServicePort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;Handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;      &lt;span class=&#34;nf&#34;&gt;recovery&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;TimeoutHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HandlerTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;server timed out, request exceeded %s\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HandlerTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;ErrorLog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;New&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;LstdFlags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;ReadTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ReadTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;WriteTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WriteTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WaitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Run HTTP server&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;errListen&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ListenAndServe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Is&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;errListen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ErrServerClosed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;errListen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;server.ListenAndServe error&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;HTTP server cancelled&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;timeoutCtx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cancel&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WithTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Second&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;cancel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;errShutdown&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Shutdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;timeoutCtx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errShutdown&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;errShutdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;server.Shutdown error&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;performTask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Dur&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;duration&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Since&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;startService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Service started successfully&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;runningService&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Step 2: Runtime&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;stop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Step 3: Shutdown&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Dur&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;duration&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Since&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;runningService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Gracefully shutting down service...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;startGracefullyShuttingDown&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;waitGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Dur&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;duration&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Since&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;startGracefullyShuttingDown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Shutdown service complete&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;key-takeaways&#34;&gt;Key Takeaways
&lt;/h3&gt;&lt;p&gt;• &lt;strong&gt;Design for failure&lt;/strong&gt;—applications must withstand underlying software or hardware failures.&lt;br&gt;
• &lt;strong&gt;Graceful degradation&lt;/strong&gt; and &lt;strong&gt;eventual consistency&lt;/strong&gt; improve reliability and availability.&lt;br&gt;
• Proper use of probes and shutdown mechanisms ensures stable and efficient management of Go applications in Kubernetes.&lt;/p&gt;
&lt;p&gt;Developers can build resilient systems that handle disruptions seamlessly by implementing these best practices. 🚀&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/go-action-managing-go-application-lifecycles-in-kubernetes/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Why Did Go&#39;s Map Get Slower? Let&#39;s See How Go 1.25 Plans to Fix It</title>
        <link>https://huizhou92.com/p/why-did-gos-map-get-slower-lets-see-how-go-1.25-plans-to-fix-it/</link>
        <pubDate>Tue, 20 May 2025 22:22:53 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/why-did-gos-map-get-slower-lets-see-how-go-1.25-plans-to-fix-it/</guid>
        <description>&lt;blockquote&gt;
&lt;p&gt;This article explains why your program might have gotten slower using maps in Go 1.24, and how the Go team plans to fix this issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The feature in Go 1.24 that excited me most was &lt;strong&gt;SwissMap&lt;/strong&gt;. Previously, some unofficial implementations showed up to 50% performance improvements in certain scenarios. The official implementation also provided noticeable gains. You can find more details in my earlier articles:&lt;/p&gt;
&lt;h2 id=&#34;swisstable-a-high-performance-hash-table-implementation&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/swisstable-a-high-performance-hash-table-implementation/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SwissTable: A High-Performance Hash Table Implementation&lt;/a&gt;
&lt;/h2&gt;&lt;h2 id=&#34;swiss-map-in-go-124-compatibility-extendible-hashing-and-legacy-issues&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/swiss-map-in-go-124-compatibility-extendible-hashing-and-legacy-issues/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Swiss Map in Go 1.24: Compatibility, Extendible Hashing, and Legacy Issues&lt;/a&gt;
&lt;/h2&gt;&lt;p&gt;However, you might have noticed that &lt;strong&gt;SwissMap&lt;/strong&gt; in Go 1.24 doesn&amp;rsquo;t perform as expected and might even slow down your programs, especially with large maps. This isn&amp;rsquo;t your imagination—it’s a real issue.&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/05/585b320bdb723bc6aa22e592aea367b0.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Pasted image 20250520225126&#34;
	
	
&gt;&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://x.com/valyala/status/1879988053076504761&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://x.com/valyala/status/1879988053076504761&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The issue has been documented in &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/70835&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Issue #70835&lt;/a&gt;, and the developers are actively working to address it.&lt;/p&gt;
&lt;h2 id=&#34;whats-the-problem&#34;&gt;What&amp;rsquo;s the Problem?
&lt;/h2&gt;&lt;p&gt;Go&amp;rsquo;s maps in the latest version use a Swiss Table structure, which is very fast for small maps and highly concurrent scenarios. However, performance degrades significantly when maps become large and data isn&amp;rsquo;t cached by the CPU (so-called &amp;ldquo;cold&amp;rdquo; data).&lt;/p&gt;
&lt;p&gt;Why does this happen?&lt;/p&gt;
&lt;p&gt;Because SwissMap has a relatively complex internal structure, it organizes data in multiple layers:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A header structure for the map.&lt;/li&gt;
&lt;li&gt;A directory pointing to a list of table pointers.&lt;/li&gt;
&lt;li&gt;Each table contains control information, keys, and values.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/01/784e3f6a0ff90601480a2da80f3cb9d0.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;When you look up a key, you might encounter &lt;strong&gt;4 to 6 memory jumps&lt;/strong&gt;, each potentially resulting in a cache miss. This causes the CPU to frequently fetch data from slower main memory, significantly reducing speed.&lt;/p&gt;
&lt;p&gt;Large projects like Prometheus noticed this issue clearly after upgrading to Go 1.24, where CPU usage increased dramatically. Upon investigation, it turned out to be due to slower map lookups.&lt;/p&gt;
&lt;h2 id=&#34;how-was-it-discovered&#34;&gt;How Was It Discovered?
&lt;/h2&gt;&lt;p&gt;Test cases didn&amp;rsquo;t detect this issue but instead surfaced in real-world scenarios:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using huge maps (several megabytes in size).&lt;/li&gt;
&lt;li&gt;Frequent reads from the map.&lt;/li&gt;
&lt;li&gt;Data was not cached in the CPU’s fast cache.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Michael Pratt from the Go team conducted extensive testing to identify the cause of map access slowdown and detailed his findings in &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/70835&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Issue #70835&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;how-will-it-be-fixed&#34;&gt;How Will It Be Fixed?
&lt;/h2&gt;&lt;p&gt;To make maps faster, the Go team plans several key changes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Simplify directory structure&lt;/strong&gt;: Replace pointer lists with direct structure storage, reducing one memory jump.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Compact control information&lt;/strong&gt;: Organize control data more densely to enable more effortless CPU loading.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Separate keys and values&lt;/strong&gt;: Change layout to &amp;ldquo;key-key-key + value-value-value&amp;rdquo; for optimized memory access.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Align control bytes&lt;/strong&gt;: Align control information to CPU cache lines to minimize cache misses.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These changes are quite challenging since they impact Go’s runtime core:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Garbage collection must continue to work correctly.&lt;/li&gt;
&lt;li&gt;Map resizing logic needs updating.&lt;/li&gt;
&lt;li&gt;Performance for small maps must remain unaffected.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;where-can-you-follow-the-discussion&#34;&gt;Where Can You Follow the Discussion?
&lt;/h2&gt;&lt;p&gt;This issue is actively discussed and tracked. You can find more details in &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/70835&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Issue #70835&lt;/a&gt;. The &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/milestone/122&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Go Release Dashboard&lt;/a&gt; has already marked this issue for resolution in Go 1.25. Additionally, &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/71368&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Issue #71368&lt;/a&gt; discusses another related memory layout issue.&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion
&lt;/h2&gt;&lt;p&gt;The Go team consistently strives to enhance the language’s speed and reliability. &lt;code&gt;SwissMap&lt;/code&gt; is a significant improvement, but it has also brought new challenges, such as the recent performance degradation for cold caches.&lt;/p&gt;
&lt;p&gt;Issue #70835 demonstrates how Go continuously improves through community feedback. Thanks to open-source projects like Prometheus, their reports help make Go better.&lt;/p&gt;
&lt;p&gt;If all goes well, Go 1.25 will restore the balance between speed and stability.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s look forward to it together!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>A Deep Dive into Go’s Garbage Collector: Bottlenecks, Benchmarks, and Green Tea GC Improvements</title>
        <link>https://huizhou92.com/p/a-deep-dive-into-gos-garbage-collector-bottlenecks-benchmarks-and-green-tea-gc-improvements/</link>
        <pubDate>Mon, 05 May 2025 16:32:57 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/a-deep-dive-into-gos-garbage-collector-bottlenecks-benchmarks-and-green-tea-gc-improvements/</guid>
        <description>&lt;p&gt;Although Go’s garbage collection (GC) mechanism has undergone multiple rounds of optimization in recent years, its performance bottlenecks — especially in high-concurrency and large-memory scenarios — remain a significant focus for developers. Recently, the official Go team stirred up a discussion on GitHub with their proposal for &lt;strong&gt;Green Tea GC&lt;/strong&gt; (#73581): can it further address the time cost of Go’s GC? This article dives deep into Go&amp;rsquo;s GC&amp;rsquo;s design, shortcomings, and real-world performance — and looks at the technical breakthroughs behind Green Tea GC.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.reddit.com/r/golang/comments/173n28q/the_myth_of_go_garbage_collection_hindering/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.reddit.com/r/golang/comments/173n28q/the_myth_of_go_garbage_collection_hindering/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;-design-and-implementation-of-go-gc&#34;&gt;📦 Design and Implementation of Go GC
&lt;/h2&gt;&lt;p&gt;Since Go 1.5, Go has used a concurrent mark-sweep algorithm combined with the &lt;strong&gt;tri-color marking&lt;/strong&gt; model and &lt;strong&gt;yuasa-style&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In simple terms, Go’s GC runs in the background, concurrently traversing the heap, marking reachable objects, and gradually cleaning up unreferenced memory blocks. Throughout this process, Go aims for &lt;strong&gt;low latency and minimal pause times&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;✅ Concurrent marking and sweeping&lt;br&gt;
✅ No object movement (i.e., no compaction)&lt;br&gt;
✅ Batch sweeping by spans (memory blocks) to reduce the duration of each Stop-the-World (STW) phase&lt;/p&gt;
&lt;p&gt;This design&amp;rsquo;s direct benefit is that applications can mostly run in parallel with GC, keeping maximum pause times typically below the millisecond level.&lt;/p&gt;
&lt;h2 id=&#34;-known-issues-with-go-gc&#34;&gt;🚧 Known Issues with Go GC
&lt;/h2&gt;&lt;p&gt;While Go GC delivers excellent latency, it still has several hard-to-ignore issues when it comes to time consumption and scalability, particularly:&lt;/p&gt;
&lt;p&gt;1️⃣ &lt;strong&gt;Inefficient memory access&lt;/strong&gt;&lt;br&gt;
During the mark phase, GC jumps across objects, causing frequent CPU cache misses and memory waits — about 35% of GC’s CPU cycles are spent “waiting on memory.” This problem is especially pronounced on NUMA architectures or multi-core, large-memory machines.&lt;/p&gt;
&lt;p&gt;2️⃣ &lt;strong&gt;Lack of generational collection&lt;/strong&gt;&lt;br&gt;
Go GC has no generational mechanism; all objects are treated the same. This becomes cumbersome in high-allocation scenarios. Engineers at Pinterest have pointed out that GC’s CPU usage spikes when memory pressure rises, triggering latency surges.&lt;/p&gt;
&lt;p&gt;3️⃣ &lt;strong&gt;High CPU usage from frequent GCs&lt;/strong&gt;&lt;br&gt;
Twitch’s engineering team reported that even with small to medium heaps (&amp;lt;450 MiB), under steady-state conditions, the system triggers 8–10 GCs per second, up to 400–600 per minute, consuming roughly &lt;strong&gt;30% of CPU time&lt;/strong&gt;. This directly squeezes out the execution time for application threads.&lt;/p&gt;
&lt;h2 id=&#34;-performance-testing-how-gc-impacts-go-programs&#34;&gt;📊 Performance Testing: How GC Impacts Go Programs
&lt;/h2&gt;&lt;p&gt;Let’s look at some real-world benchmark changes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Go 1.3/1.4 (before concurrent GC)&lt;/strong&gt;&lt;br&gt;
On large heaps (10GB+), GC pauses were measured in seconds.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Go 1.5 (with concurrent GC introduced)&lt;/strong&gt;&lt;br&gt;
Under the same conditions, GC pauses shrank to &amp;lt;1ms.&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/05/8d6a9563ad431b76e34d31077cbcd82b.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Pasted image 20250504161704&#34;
	
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Go 1.6–1.8&lt;/strong&gt;&lt;br&gt;
With heaps up to 200GB, GC pauses stayed under 20ms, often around 1ms in normal operation.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These improvements are impressive, but note:&lt;br&gt;
✅ Latency control is excellent&lt;br&gt;
⚠️ Total time spent and CPU consumption remain significant, especially under heavy load or high allocation rates.&lt;/p&gt;
&lt;h2 id=&#34;-green-tea-gc-a-new-optimization-approach&#34;&gt;🌿 Green Tea GC: A New Optimization Approach
&lt;/h2&gt;&lt;p&gt;To address these issues, the Go team has proposed Green Tea GC. Its core innovation is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Upgrading from per-object scanning to per-span (memory block) batch scanning.&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Specifically:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For small objects (≤512B), marking moves from per-object granularity to span-level granularity.&lt;/li&gt;
&lt;li&gt;Only the first marked object pushes the entire span into the scan queue within each span.&lt;/li&gt;
&lt;li&gt;During the GC scan phase, entire spans are batch-processed, significantly improving memory access locality.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Additionally, Green Tea improves parallel queue management, using a work-stealing mechanism similar to Go’s scheduler, further boosting multi-core scalability.&lt;/p&gt;
&lt;h2 id=&#34;-green-tea-gc-in-benchmark-tests&#34;&gt;⚡ Green Tea GC in Benchmark Tests
&lt;/h2&gt;&lt;p&gt;Initial benchmarks show that Green Tea GC delivers selective performance gains:&lt;/p&gt;
&lt;p&gt;✅ &lt;strong&gt;Tile38 benchmark (high-fanout tree structures)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GC overhead reduced by ~35%&lt;/li&gt;
&lt;li&gt;Throughput, latency, and memory usage all improved&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;⚠ &lt;strong&gt;bleve-index benchmark (low-fanout, highly mutating workloads)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Objects are scattered with poor memory locality.&lt;/li&gt;
&lt;li&gt;Green Tea’s performance is similar to, or sometimes slightly worse than, standard GC.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Summary: Green Tea isn’t a “silver bullet,” but it shows clear advantages in workloads with good memory locality and heavy multi-core scaling — and lays the groundwork for future hardware optimizations like SIMD acceleration.&lt;/p&gt;
&lt;h2 id=&#34;-summary&#34;&gt;🏁 Summary
&lt;/h2&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Comparison Item&lt;/th&gt;
          &lt;th&gt;Current Go GC&lt;/th&gt;
          &lt;th&gt;Green Tea GC&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Marking granularity&lt;/td&gt;
          &lt;td&gt;Per object&lt;/td&gt;
          &lt;td&gt;Per span (batch)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Memory locality&lt;/td&gt;
          &lt;td&gt;Poor, random jumps&lt;/td&gt;
          &lt;td&gt;High, batches within the same span&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Multi-core scalability&lt;/td&gt;
          &lt;td&gt;Limited&lt;/td&gt;
          &lt;td&gt;Improved, using work-stealing queues&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Performance gains&lt;/td&gt;
          &lt;td&gt;Near low-latency limits&lt;/td&gt;
          &lt;td&gt;Up to 35% GC time reduction in some cases&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Suitable application&lt;/td&gt;
          &lt;td&gt;General workloads&lt;/td&gt;
          &lt;td&gt;Memory-locality-rich, allocation-heavy workloads&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;For developers chasing extreme performance, Green Tea GC offers an exciting new direction. To try it out, you can enable the experimental flag in Go 1.25+.&lt;/p&gt;
&lt;p&gt;📝 &lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/73581&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GitHub Issue #73581&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://stackoverflow.com/questions/31684862/how-fast-is-the-go-1-5-gc-with-terabytes-of-ram&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://stackoverflow.com/questions/31684862/how-fast-is-the-go-1-5-gc-with-terabytes-of-ram&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.reddit.com/r/golang/comments/173n28q/the_myth_of_go_garbage_collection_hindering/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.reddit.com/r/golang/comments/173n28q/the_myth_of_go_garbage_collection_hindering/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/a-deep-dive-into-gos-garbage-collector-bottlenecks-benchmarks-and-green-tea-gc-improvements/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>The Importance of Website Icons (Favicon)</title>
        <link>https://huizhou92.com/p/the-importance-of-website-icons-favicon/</link>
        <pubDate>Tue, 18 Feb 2025 11:30:38 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/the-importance-of-website-icons-favicon/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/02/65e64661a046efca8dcbc39b98ae2b91.png" alt="Featured image of post The Importance of Website Icons (Favicon)" /&gt;&lt;p&gt;Recently, &lt;a class=&#34;link&#34; href=&#34;https://taoshu.in/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Tao Shu&amp;rsquo;s Blog&lt;/a&gt; published an article about reciprocal links, and I took the initiative to request a link exchange. Tao Shu promptly responded and kindly reminded me that adding a &lt;code&gt;favicon (icon)&lt;/code&gt; to my blog would help RSS subscribers quickly identify it. At that moment, I wondered, &amp;ldquo;What is a &lt;code&gt;favicon&lt;/code&gt;?&amp;rdquo; (The struggles of a backend developer!)&lt;/p&gt;
&lt;p&gt;Later, I consulted DeepSeek:&lt;br&gt;
In web design, icons are small yet significant elements. They assist users in quickly identifying a website and enhancing the overall user experience.&lt;/p&gt;
&lt;h3 id=&#34;common-usage-scenarios&#34;&gt;Common Usage Scenarios:
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Browser Tab&lt;/strong&gt;: Displayed next to the webpage title.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bookmark Bar&lt;/strong&gt;: Shown when users save a webpage.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Home Screen Icon&lt;/strong&gt;: Displayed when a webpage is added to the home screen on mobile devices.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PWA (Progressive Web App)&lt;/strong&gt;: Used as the application icon.&lt;br&gt;
For example:&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/6df56f22e8fad0c4fe55bffcab3ed090.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Icon displayed in the browser tab&#34;
	
	
&gt;&lt;br&gt;
Icon displayed in the browser tab.&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/c2530b4f9491c01730c710dcd24a325f.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Icon displayed in the bookmark bar.&#34;
	
	
&gt;&lt;br&gt;
The icon displayed in the bookmark bar.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The icon can be displayed even on Android devices, as the Chrome browser&amp;rsquo;s feature to add a webpage to the home screen allows this.&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/861e9e820063fe4d7bbff32e9f8de05b.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Using Android Chrome to add a webpage to the phone’s home screen&#34;
	
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;how-to-set-up&#34;&gt;How to Set Up
&lt;/h2&gt;&lt;p&gt;The simplest way to set an icon is to add a line in the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; section of the webpage.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;icon&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;image/png&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/favicon.png&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;If you are using Hugo or other tools, there may be specific settings for the favicon.&lt;br&gt;
Some large websites, such as &lt;code&gt;google.com&lt;/code&gt; and &lt;code&gt;apple.com&lt;/code&gt;, may have more considerations, and their setups may differ.&lt;/p&gt;
&lt;h2 id=&#34;important-considerations&#34;&gt;Important Considerations
&lt;/h2&gt;&lt;p&gt;The icon size is also essential to optimize the user experience and achieve the best display effect across various scenarios.&lt;/p&gt;
&lt;h3 id=&#34;common-sizes&#34;&gt;Common Sizes:
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;16x16&lt;/strong&gt;: Browser tab icon.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;32x32&lt;/strong&gt;: Bookmark bar icon.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;64x64&lt;/strong&gt;: High-resolution screen icon.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;180x180&lt;/strong&gt;: iOS device home screen icon.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;192x192&lt;/strong&gt; and &lt;strong&gt;512x512&lt;/strong&gt;: PWA icons.&lt;br&gt;
This is why we often see multiple icons set on some websites, such as the &lt;a class=&#34;link&#34; href=&#34;https://gohugo.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Hugo website&lt;/a&gt;.&lt;br&gt;
&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/4d83d2d0666f924072095b981ba2ff0e.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Hugo website has set two icons&#34;
	
	
&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Modern browsers support selecting different icon sizes based on various scenarios and screen PPI, striving to achieve the best display effect in all situations.&lt;/p&gt;
&lt;h3 id=&#34;choosing-icon-formats&#34;&gt;Choosing Icon Formats
&lt;/h3&gt;&lt;p&gt;Icons can be created in different image formats, specified by the type attribute. Standard icon formats include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ICO&lt;/strong&gt;: Traditional format, good compatibility, supports multiple sizes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PNG&lt;/strong&gt;: Modern format, supports transparent backgrounds, and is suitable for high-resolution screens.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SVG&lt;/strong&gt;: Vector format, infinitely scalable without losing quality, suitable for responsive design.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;multi-resolution-icons&#34;&gt;Multi-Resolution Icons
&lt;/h3&gt;&lt;p&gt;If maintaining multiple icon files seems cumbersome, you can use a multi-resolution icon (Multi-Resolution ICO or Multi-Size ICO), a single file containing various sizes and color depths. This allows multiple bitmaps (BMP or PNG format) to be stored in one file.&lt;br&gt;
An ICO file includes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;File Header&lt;/strong&gt;: Defines the ICO file type and the number of images it contains.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Image Directory&lt;/strong&gt;: Describes the size, color depth, offset, and other information for each image.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Image Data&lt;/strong&gt;: Contains the actual pixel data for the images.&lt;br&gt;
When a browser needs an icon, it selects the most appropriate size from the ICO file. The downside is that an ICO file containing multiple sizes may be larger than a file with a single size.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This article does not delve deeper into topics such as the &lt;code&gt;manifest.json&lt;/code&gt; unique to Android Chrome or the &lt;code&gt;apple-mobile-web-app-capable&lt;/code&gt; for Apple devices. Interested readers are encouraged to explore further.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/the-importance-of-website-icons-favicon/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Unmasking Go Memory Leaks: CloudWeGo Open Sources goref for Deep Heap Analysis</title>
        <link>https://huizhou92.com/p/unmasking-go-memory-leaks-cloudwego-open-sources-goref-for-deep-heap-analysis/</link>
        <pubDate>Thu, 13 Feb 2025 15:05:56 +0800</pubDate>
        
        <guid>https://huizhou92.com/p/unmasking-go-memory-leaks-cloudwego-open-sources-goref-for-deep-heap-analysis/</guid>
        <description>&lt;img src="https://images.hxzhouh.com/blog-images/2025/02/f1e888e98523470202649a4a1fe3d769.png" alt="Featured image of post Unmasking Go Memory Leaks: CloudWeGo Open Sources goref for Deep Heap Analysis" /&gt;&lt;p&gt;In Go language development, memory leak issues are often challenging to pinpoint. While traditional pprof tools can provide some assistance, their capabilities are limited in complex scenarios. To analyze and resolve these issues more effectively, the CloudWeGo team has developed a new tool called &lt;a class=&#34;link&#34; href=&#34;https://github.com/cloudwego/goref&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;goref&lt;/a&gt;.&lt;br&gt;
Based on Delve, goref can deeply analyze heap object references in Go programs, displaying the distribution of memory references to help developers quickly locate memory leaks or optimize garbage collection (GC) overhead. This tool supports the analysis of runtime processes and core dump files, providing Go developers with a powerful memory analysis tool.&lt;/p&gt;
&lt;!-- more--&gt;
&lt;h2 id=&#34;limitations-of&#34;&gt;&lt;strong&gt;Limitations Of &lt;code&gt;pprof&lt;/code&gt;&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;When encountering memory leaks in Go development, most people first attempt to generate a heap profile to investigate the issue. However, the heap profile flame graph often does not provide much help in troubleshooting because it only records where objects are created. In complex business scenarios, where objects are passed through multiple layers of dependencies or reused from memory pools, it becomes nearly impossible to identify the root cause based solely on the stack information of the creation.&lt;/p&gt;
&lt;p&gt;For example, in the following heap profile, the FastRead function stack is a deserialization function from the Kitex framework. If a business coroutine leaks a request object, it does not reflect the corresponding leaking code location but only shows that the FastRead function stack occupies memory.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/239158570664af753f62f917f60a488c.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Heap Profile Example&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;As we know, Go is a garbage-collected language, and an object cannot be released primarily because the GC marks it as alive through reference analysis. Similarly, as a GC language, Java has more sophisticated analysis tools, such as &lt;code&gt;JProfiler&lt;/code&gt;, which can effectively display object reference relationships. Therefore, we also wanted to implement an efficient reference analysis tool in Go that can accurately and directly inform us of memory reference distribution and relationships, liberating us from the arduous task of static analysis. The good news is that we have nearly completed the development of this tool, which is open-sourced in the &lt;a class=&#34;link&#34; href=&#34;https://github.com/cloudwego/goref&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;goref repository&lt;/a&gt;, with usage instructions available in the README document.&lt;/p&gt;
&lt;p&gt;The following sections will share the design ideas and detailed implementation of this tool.&lt;/p&gt;
&lt;h2 id=&#34;implementation-ideas-of-goref&#34;&gt;Implementation Ideas of Goref
&lt;/h2&gt;&lt;h3 id=&#34;gc-marking-process&#34;&gt;&lt;strong&gt;GC Marking Process&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Before discussing the specific implementation, let’s review how the GC marks objects as alive.&lt;/p&gt;
&lt;p&gt;Go employs a tiered allocation scheme similar to tcmalloc, where each heap object is assigned to an &lt;code&gt;mspan&lt;/code&gt; during allocation, with a fixed size. During GC, a heap address calls &lt;code&gt;runtime.spanOf&lt;/code&gt; to find this &lt;code&gt;mspan&lt;/code&gt; from a multi-level index, thus obtaining the base address and size of the original object.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// simplified code&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;spanOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mspan&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;ri&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;arenaIndex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mheap_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arenas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;l1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()][&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;l2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;spans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pageSize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pagesPerArena&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;By using the &lt;code&gt;runtime.heapBitsForAddr&lt;/code&gt; function, we can obtain a GC bitmap for an object address range. The GC bitmap indicates whether each 8-byte aligned address in the memory of an object is a pointer type, thus determining whether to further mark downstream objects.&lt;/p&gt;
&lt;p&gt;For example, consider the following Go code snippet:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// global variables&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;B&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;When the GC scans the variable &lt;code&gt;b&lt;/code&gt;, it does not simply scan the memory of the &lt;code&gt;B int64&lt;/code&gt; field; instead, it looks up the &lt;code&gt;base&lt;/code&gt; and &lt;code&gt;elem size&lt;/code&gt; through the &lt;code&gt;mspan&lt;/code&gt; index and then scans, marking the memory of fields A and C, as well as their downstream objects, as alive.&lt;/p&gt;
&lt;p&gt;When scanning the variable &lt;code&gt;a&lt;/code&gt;, the corresponding GC bit is &lt;code&gt;1001&lt;/code&gt;. How should we interpret this? We can consider that the addresses &lt;code&gt;base+0&lt;/code&gt; and &lt;code&gt;base+24&lt;/code&gt; are pointers, indicating that downstream objects should be scanned further. Here, both &lt;code&gt;A string&lt;/code&gt; and &lt;code&gt;C *[]byte&lt;/code&gt; contain pointers to downstream objects.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/0508442cfe2fa8bed8f129f0e12c450e.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;GC Bitmap Example&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Based on the above brief analysis, we can see that to find all live objects, the simple principle is to start from the GC Root and scan the GC bits of each object. If an address is marked as &lt;code&gt;1&lt;/code&gt;, we continue scanning downstream. Each downstream address must determine its &lt;code&gt;mspan&lt;/code&gt; to obtain the complete object base address, size, and GC bit.&lt;/p&gt;
&lt;h3 id=&#34;dwarf-type-information&#34;&gt;&lt;strong&gt;DWARF Type Information&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;However, merely knowing the reference relationships of objects is almost useless for troubleshooting, as it does not output any effective variable names or type information for developers to locate issues. Therefore, another crucial step is to obtain the variable names and type information of these objects.&lt;/p&gt;
&lt;p&gt;Go is a statically typed language, and objects generally do not directly contain their type information. For instance, when we create an object using &lt;code&gt;obj=new(Object)&lt;/code&gt;, the actual memory only stores the values of fields &lt;code&gt;A/B/C&lt;/code&gt;, occupying only 32 bytes in memory. Given this, how can we obtain type information?&lt;/p&gt;
&lt;h2 id=&#34;implementation-of-goref&#34;&gt;&lt;strong&gt;Implementation Of goref&lt;/strong&gt;
&lt;/h2&gt;&lt;h3 id=&#34;introduction-to-delve-tool&#34;&gt;&lt;strong&gt;Introduction To Delve Tool&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;Those who have experience in Go development should be familiar with Delve. If you think you haven’t used it, don’t doubt yourself; the debugging functionality you use in the Goland IDE is fundamentally based on Delve. At this point, you may recall the debugging window during your debugging sessions. Indeed, the variable names, values, and types displayed in the debugging window are precisely the type information we need!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-makefile&#34; data-lang=&#34;makefile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;./dlv&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;attach&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;270&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;(dlv)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;(dlv)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;locals&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;tccCli&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;*code.byted.org/gopkg/tccclient.ClientV2&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)(&lt;/span&gt;0xc000782240&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ticker&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*time.Ticker&lt;span class=&#34;o&#34;&gt;)(&lt;/span&gt;0xc001086be0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;So, how does Delve obtain this variable information? Delve reads the executable file path from the soft link in&lt;code&gt; /proc/&amp;lt;pid&amp;gt;/exe&lt;/code&gt; when we attach it to a process. Go generates debugging information during compilation, stored in sections with the &lt;code&gt;.debug_*&lt;/code&gt; prefix in the executable file, following the DWARF standard format. The type of information required for reference analysis for global and local variables can be parsed from this DWARF information.&lt;/p&gt;
&lt;p&gt;For global variables, Delve iterates through all DWARF Entries, parsing those with the &lt;code&gt;Variable&lt;/code&gt; tag. These Entries contain attributes such as Location, Type, and Name.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The Type attribute records its type information, which can be recursively traversed in DWARF format to determine the type of each sub-object further.&lt;/li&gt;
&lt;li&gt;The Location attribute is a relatively complex property that records either an executable expression or a simple variable address, serving to determine a variable&amp;rsquo;s memory address or return a register&amp;rsquo;s value. During global variable parsing, Delve uses this to obtain the variable&amp;rsquo;s memory address.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The principle for parsing local variables in goroutines is similar to that of global variables, but it is somewhat more complex. For example, it requires determining the DWARF offset based on the PC, and the location expressions are more complicated, involving register access. We will not elaborate on this here.&lt;/p&gt;
&lt;h3 id=&#34;building-gc-analysis-metadata&#34;&gt;&lt;strong&gt;Building GC Analysis Metadata&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;We can also obtain memory access permissions by utilizing Delve&amp;rsquo;s process attachment and core file analysis capabilities. We mimic the GC marking process for objects, constructing the necessary metadata for the process to be analyzed in the tool&amp;rsquo;s runtime memory. This includes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The address space range of each Goroutine stack in the process to be analyzed, including the &lt;code&gt;stackmap&lt;/code&gt; that stores the gcmask for each Goroutine stack, used to mark whether it may point to a live heap object.&lt;/li&gt;
&lt;li&gt;The address space range of each &lt;code&gt;data/bss&lt;/code&gt; segment in the process to be analyzed, including the &lt;code&gt;gcmask&lt;/code&gt; for each segment, is also used to mark whether it may point to a live heap object.&lt;/li&gt;
&lt;li&gt;The above two steps are necessary to obtain GC Roots.&lt;/li&gt;
&lt;li&gt;The final step is to read the &lt;code&gt;mspan&lt;/code&gt; index of the process to be analyzed, along with the base, &lt;code&gt;elem&lt;/code&gt; size, &lt;code&gt;gcmask&lt;/code&gt;, and other information for each &lt;code&gt;mspan&lt;/code&gt;, restoring this index in the tool&amp;rsquo;s memory.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These steps outline the general process, which also involves handling some detail issues, such as dealing with GC finalizer objects and special handling of allocation header features in Go version 1.22, which we will not delve into here.&lt;/p&gt;
&lt;h3 id=&#34;dwarf-type-scanning&#34;&gt;&lt;strong&gt;DWARF Type Scanning&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;With everything in place, we are ready for the most critical step: &lt;strong&gt;object reference relationship&lt;/strong&gt; analysis.&lt;/p&gt;
&lt;p&gt;We call each GC Root variable the &lt;code&gt;findRef&lt;/code&gt; function, accessing the object&amp;rsquo;s memory according to different DWARF types. If it is a pointer that may point to downstream objects, we read the pointer&amp;rsquo;s value and find this downstream object in the GC metadata. We have obtained the object&amp;rsquo;s base address, &lt;code&gt;elem size&lt;/code&gt;, &lt;code&gt;gcmask&lt;/code&gt;, and other information.&lt;/p&gt;
&lt;p&gt;If the object is accessed, we record a mark bit to avoid re-accessing the object. By constructing a new variable with the DWARF sub-object type, we recursively call &lt;code&gt;findRef&lt;/code&gt; until all known types of objects are confirmed.&lt;/p&gt;
&lt;p&gt;However, this reference scanning method is entirely contrary to the GC approach. The main reason is that Go has many unsafe type conversions. For instance, an object created with pointer fields may look like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-css&#34; data-lang=&#34;css&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Object&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(*&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;From the GC&amp;rsquo;s perspective, although the type has been converted to &lt;code&gt;*byte&lt;/code&gt; using unsafe, it does not affect its gcmask marking. Therefore, when scanning downstream objects, we can still scan the complete &lt;code&gt;Object&lt;/code&gt; object and identify the &lt;code&gt;bytes&lt;/code&gt; downstream object, marking it as alive.&lt;/p&gt;
&lt;p&gt;However, DWARF type scanning cannot achieve this. When it encounters the &lt;code&gt;byte&lt;/code&gt; type, it will consider it a non-pointer object and skip further scanning. Thus, the only solution is to prioritize DWARF type scanning, and for objects that cannot be scanned, we will use the GC method to mark them.&lt;/p&gt;
&lt;p&gt;To implement this, whenever we access a pointer to an object using DWARF types, we will mark its corresponding gcmask from 1 to 0. After scanning an object, if there are still non-zero marked pointers within the object&amp;rsquo;s address space, we will record them for final marking tasks. Once all objects have been scanned using DWARF types, we will extract these final marking tasks and perform a secondary scan using the GC method.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/5cf29b2538c1bc30ed68212738da45ca.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Reference Scanning Example&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;For example, when accessing the aforementioned &lt;code&gt;Object&lt;/code&gt;, its gcmask is &lt;code&gt;1010&lt;/code&gt;. After reading field A, the gcmask changes to &lt;code&gt;1000&lt;/code&gt;. If field C is not accessed due to type conversion, it will be included in the final scan during GC marking.&lt;/p&gt;
&lt;p&gt;In addition to type conversion, memory out-of-bounds references are also common issues. For instance, in the example code &lt;code&gt;var b *int64 = &amp;amp;echo().B&lt;/code&gt;, fields A and C belong to memory that cannot be scanned using DWARF types and will also be counted during the final scan.&lt;/p&gt;
&lt;h3 id=&#34;final-scan&#34;&gt;&lt;strong&gt;Final Scan&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;The fields that were type-converted or could not be accessed due to exceeding the DWARF-defined address range, as well as variables like &lt;code&gt;unsafe.Pointer&lt;/code&gt; whose types cannot be determined, will all be marked during the final scan. Since these objects cannot be assigned specific types, we only need to record their size and count in the known reference chain.&lt;/p&gt;
&lt;p&gt;In Go&amp;rsquo;s native implementation, many commonly used libraries utilize &lt;code&gt;unsafe.Pointer&lt;/code&gt;, leading to issues with sub-object identification. These types require special handling.&lt;/p&gt;
&lt;h3 id=&#34;output-file-format&#34;&gt;&lt;strong&gt;Output File Format&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;After scanning all objects, the reference chains, object counts, and object memory spaces are output to a file, aligned with the pprof binary file format and encoded using protobuf.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Root Object Format:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Stack Variable Format: Package name + Function name + Stack variable name &lt;code&gt;github.com/cloudwego/kitex/client.invokeHandleEndpoint.func1.sendMsg&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Global Variable Format: Package name + Global variable name &lt;code&gt;github.com/cloudwego/kitex/pkg/loadbalance/lbcache.balancerFactories&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Sub-object Format:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Outputs the type name of the sub-object, such as: &lt;code&gt;net.Conn&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;If it is a map key or value field, it is output in the form of &lt;code&gt;$mapkey. (type_name)&lt;/code&gt; or &lt;code&gt;$mapval. (type_name)&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;If it is an element of an array, it is output in the format &lt;code&gt;[0]. (type_name)&lt;/code&gt;; for elements greater than or equal to 10, it is output as &lt;code&gt;[10+]. (type_name)&lt;/code&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;effect-demonstration&#34;&gt;&lt;strong&gt;Effect Demonstration&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;Below is a flame graph of object references sampled from a real business using the tool:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/bc938a980366ba9cf0877327496ba553.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Object Reference Flame Graph&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;The graph displays the names of each root variable, along with the names and types of the fields they reference. Note: Due to the lack of support for closure type field offsets in DWARF Info before Go 1.23, the closure variable &lt;code&gt;wpool.(*Pool).GoCtx.func1.task&lt;/code&gt; cannot currently display downstream objects.&lt;/p&gt;
&lt;p&gt;By selecting the &lt;code&gt;inuse_objects&lt;/code&gt; tag, you can also view the flame graph of object count distribution:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://images.hxzhouh.com/blog-images/2025/02/1fce789445b070cdac3aa9a0b7665479.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;Object Count Distribution Flame Graph&#34;
	
	
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/p/unmasking-go-memory-leaks-cloudwego-open-sources-goref-for-deep-heap-analysis/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Long Time Link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you find my blog helpful, please subscribe to me via &lt;a class=&#34;link&#34; href=&#34;https://huizhou92.com/index.xml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Or follow me on &lt;a class=&#34;link&#34; href=&#34;https://x.com/@piaopiaopig&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If you have a &lt;a class=&#34;link&#34; href=&#34;https://medium.huizhou92.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Medium&lt;/a&gt; account, follow me there. My articles will be published there as soon as possible.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
    </channel>
</rss>
